<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Gitä»£ç å›æ»š</title>
    <url>/relaxed/git-back/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>&ensp;åœ¨æˆ‘ä»¬å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå› å„ç§åŸå› ï¼Œé¿å…ä¸äº†å°†ä¸šåŠ¡ä»£ç å›æ»šè‡³æŒ‡å®šç‰ˆæœ¬ï¼Œæˆ–è€…å…·ä½“ä¸€äº›åˆ°æŸæ¬¡commitã€‚<br>ä¸‹é¢æˆ‘ä»¬å°†å…·ä½“æ­¥éª¤åŠå…·ä½“å®ç°åšåˆ†æã€‚</p>
<h2 id="æ“ä½œå‰é˜…è¯»"><a href="#æ“ä½œå‰é˜…è¯»" class="headerlink" title="æ“ä½œå‰é˜…è¯»"></a>æ“ä½œå‰é˜…è¯»</h2><p>&ensp; åœ¨ä»£ç å›å½’æ“ä½œè¿‡ç¨‹ä¸­ä¸»è¦ å›´ç»• git reset å‘½ä»¤è¿›è¡Œï¼Œè¯¥å‘½ä»¤ä¼šæŠŠç‰ˆæœ¬åº“å’Œå·¥ä½œç›®å½•æ”¹å˜ä¸ºå·²çŸ¥çŠ¶æ€ã€‚å…·ä½“æ¥è®²ï¼Œgit reset è°ƒæ•´ HEAD å¼•ç”¨æŒ‡å‘æŒ‡å®šçš„æäº¤ï¼Œé»˜è®¤æƒ…å†µä¸‹è¿˜ä¼šæ›´æ–°ç´¢å¼•ä»¥åŒ¹é…è¯¥æäº¤ã€‚æ ¹æ®éœ€è¦ï¼Œgit reset å‘½ä»¤ä¹Ÿå¯ä»¥ä¿®æ”¹å·¥ä½œç›®å½•ä»¥å‘ˆç°æŒ‡å®šæäº¤ä»£è¡¨çš„é¡¹ç›®ä¿®è®¢ç‰ˆæœ¬ã€‚</p>
<ul>
<li><p>git reset å‘½ä»¤æœ‰ä¸‰ä¸ªä¸»è¦é€‰é¡¹</p>
</li>
<li><p><code>--soft</code><br>&ensp; ä¼šå°† HEAD å¼•ç”¨æŒ‡å‘æŒ‡å®šæäº¤ã€‚ç´¢å¼•å’Œå·¥ä½œç›®å½•çš„å†…å®¹ä¿æŒä¸å˜ã€‚è¿™ä¸ªç‰ˆæœ¬çš„å‘½ä»¤æœ‰â€œæœ€å°â€å½±å“ï¼Œåªæ”¹å˜ä¸€ä¸ªç¬¦å·å¼•ç”¨çš„çŠ¶æ€ä½¿å…¶æŒ‡å‘ä¸€ä¸ªæ–°æäº¤ã€‚</p>
</li>
<li><p><code>--mixed</code><br>&ensp; ä¼šå°† HEAD æŒ‡å‘æŒ‡å®šæäº¤ã€‚ç´¢å¼•å†…å®¹ä¹Ÿè·Ÿç€æ”¹å˜ä»¥ç¬¦åˆæŒ‡å®šæäº¤çš„æ ‘ç»“æ„ï¼Œä½†æ˜¯å·¥ä½œç›®å½•ä¸­çš„å†…å®¹ä¿æŒä¸å˜ã€‚è¿™ä¸ªç‰ˆæœ¬çš„å‘½ä»¤å°†ç´¢å¼•å˜æˆä½ åˆšåˆšæš‚å­˜è¯¥æäº¤å…¨éƒ¨å˜åŒ–æ—¶çš„çŠ¶æ€ï¼Œå®ƒä¼šæ˜¾ç¤ºå·¥ä½œç›®å½•ä¸­è¿˜æœ‰ä»€ä¹ˆä¿®æ”¹ã€‚â€“mixed æ˜¯ git reset çš„é»˜è®¤æ¨¡å¼ã€‚</p>
</li>
<li><p><code>--hard</code><br>&ensp; è¿™æ¡å‘½ä»¤å°† HEAD å¼•ç”¨æŒ‡å‘ç»™å®šæäº¤ã€‚ç´¢å¼•çš„å†…å®¹ä¹Ÿè·Ÿç€æ”¹å˜ä»¥ç¬¦åˆç»™å®šæäº¤çš„æ ‘ç»“æ„ã€‚æ­¤å¤–ï¼Œå·¥ä½œç›®å½•çš„å†…å®¹ä¹Ÿéšä¹‹æ”¹å˜ä»¥åæ˜ ç»™å®šæäº¤è¡¨ç¤ºçš„æ ‘çš„çŠ¶æ€ã€‚å½“æ”¹å˜å·¥ä½œç›®å½•çš„æ—¶å€™ï¼Œæ•´ä¸ªç›®å½•ç»“æ„éƒ½æ”¹æˆç»™å®šæäº¤å¯¹åº”çš„æ ·å­ã€‚åšçš„ä¿®æ”¹éƒ½å°†ä¸¢å¤±ï¼Œæ–°æ–‡ä»¶å°†è¢«åˆ é™¤ã€‚åœ¨ç»™å®šæäº¤ä¸­ä½†ä¸åœ¨å·¥ä½œç›®å½•ä¸­çš„æ–‡ä»¶å°†æ¢å¤å›æ¥ã€‚</p>
</li>
</ul>
<h2 id="å…·ä½“æ­¥éª¤"><a href="#å…·ä½“æ­¥éª¤" class="headerlink" title="å…·ä½“æ­¥éª¤"></a>å…·ä½“æ­¥éª¤</h2><p>&ensp;ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤å°±å¯ä»¥è§£å†³å®Œä»£ç å›æ»šæ“ä½œ</p>
<h3 id="ç¬¬ä¸€æ­¥"><a href="#ç¬¬ä¸€æ­¥" class="headerlink" title="ç¬¬ä¸€æ­¥"></a>ç¬¬ä¸€æ­¥</h3><ul>
<li>æ‰§è¡Œ git logå‘½ä»¤æŸ¥çœ‹æ—¥å¿—ï¼Œè·å–éœ€è¦å›é€€çš„ç‰ˆæœ¬å·<br>ä¾‹å¦‚:<br><img src="https://s3.bmp.ovh/imgs/2022/03/0c4021f483bb41cf.jpg"></li>
</ul>
<h3 id="ç¬¬äºŒæ­¥"><a href="#ç¬¬äºŒæ­¥" class="headerlink" title="ç¬¬äºŒæ­¥"></a>ç¬¬äºŒæ­¥</h3><p>æ‰§è¡Œ git reset â€“-soft <commit id> ï¼Œå¦‚ git reset â€“soft 4f5e9a90edeadcc45d85f43bd861a837fa7ce4c7 ï¼Œé‡ç½®è‡³æŒ‡å®šç‰ˆæœ¬çš„æäº¤</p>
<h3 id="ç¬¬ä¸‰æ­¥"><a href="#ç¬¬ä¸‰æ­¥" class="headerlink" title="ç¬¬ä¸‰æ­¥"></a>ç¬¬ä¸‰æ­¥</h3><p>æ‰§è¡Œ git push -f origin <branch_name> å¼ºåˆ¶æäº¤å½“å‰ç‰ˆæœ¬å·</p>
<ul>
<li>&gt;Â·Â·&lt; æ­¤æ—¶æ­å–œä½ ï¼Œä½ çš„ä»£ç å›æ»šæˆåŠŸäº†</li>
</ul>
]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>Gitå¸¸ç”¨å‘½ä»¤</title>
    <url>/relaxed/git-command/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä½¿ç”¨Git å‘½ä»¤å‰ï¼Œå…ˆäº†è§£å‡ ä¸ªå…³é”®è¯çš„æ¦‚å¿µ</p>
<ul>
<li>  å·¥ä½œåŒºï¼ˆworkSpaceï¼‰</li>
<li>  æš‚ç¼“åŒºï¼ˆstage/indexï¼‰</li>
<li>  æœ¬åœ°ä»“åº“ï¼ˆRepositoryï¼‰</li>
<li>  è¿œç¨‹ä»“åº“ï¼ˆRemoteï¼‰</li>
</ul>
<p><img src="https://s3.bmp.ovh/imgs/2022/03/64aa14707f10bfb0.png"></p>
<h1 id="Git-å¸¸è§å‘½ä»¤é€ŸæŸ¥è¡¨"><a href="#Git-å¸¸è§å‘½ä»¤é€ŸæŸ¥è¡¨" class="headerlink" title="Git å¸¸è§å‘½ä»¤é€ŸæŸ¥è¡¨"></a>Git å¸¸è§å‘½ä»¤é€ŸæŸ¥è¡¨</h1><p><img src="https://ftp.bmp.ovh/imgs/2020/04/5991c03f6436c41b.jpg"></p>
<h2 id="åˆ›å»ºç‰ˆæœ¬åº“"><a href="#åˆ›å»ºç‰ˆæœ¬åº“" class="headerlink" title="åˆ›å»ºç‰ˆæœ¬åº“"></a>åˆ›å»ºç‰ˆæœ¬åº“</h2><ul>
<li><p>åˆå§‹åŒ–æœ¬åœ°gitä»“åº“ï¼ˆåˆ›å»ºæ–°ä»“åº“ï¼‰</p>
<blockquote>
<p><code>git init</code></p>
</blockquote>
</li>
<li><p>é…ç½®ç”¨æˆ·å</p>
<blockquote>
<p><code>git config --global user.name &quot;xxx&quot; </code></p>
</blockquote>
</li>
<li><p>é…ç½®é‚®ä»¶</p>
<blockquote>
<p><code>git config --global user.email &quot;xxx@xxx.com&quot; </code></p>
</blockquote>
</li>
</ul>
<h2 id="ä¿®æ”¹ä¸æäº¤"><a href="#ä¿®æ”¹ä¸æäº¤" class="headerlink" title="ä¿®æ”¹ä¸æäº¤"></a>ä¿®æ”¹ä¸æäº¤</h2><ul>
<li><p>æŸ¥çœ‹å½“å‰ç‰ˆæœ¬çŠ¶æ€ï¼ˆæ˜¯å¦ä¿®æ”¹ï¼‰</p>
<blockquote>
<p><code>git status</code></p>
</blockquote>
</li>
<li><p>æ·»åŠ ä¿®æ”¹çš„æŒ‡å®šæ–‡ä»¶è‡³index(æš‚ç¼“åŒº)</p>
<blockquote>
<p><code>git add &quot;xxx&quot;</code></p>
</blockquote>
</li>
<li><p>æ·»åŠ ä¿®æ”¹çš„æ‰€æœ‰æ–‡ä»¶è‡³index(æš‚ç¼“åŒº)</p>
<blockquote>
<p><code>git add .</code></p>
</blockquote>
</li>
<li><p> æäº¤æ–‡ä»¶ â€œxxxâ€ä¸ºæœ¬æ¬¡æäº¤çš„è¯´æ˜â€</p>
<blockquote>
<p><code>git commit -m &#39;xxx&#39; </code></p>
</blockquote>
</li>
<li><p>åˆå¹¶ä¸Šä¸€æ¬¡æäº¤<br>git commit -a -m â€˜xxxâ€™   ==&gt;&gt;ï¼ˆç­‰ä»·äºï¼‰ git add .   git commit -m â€˜xxxâ€™</p>
<blockquote>
<p><code>git commit --amend -m &#39;xxx&#39;</code></p>
</blockquote>
</li>
<li><p>å°†addå’Œcommitåˆä¸ºä¸€æ­¥</p>
<blockquote>
<p><code>git commit -am &#39;xxx&#39;</code></p>
</blockquote>
</li>
</ul>
<h2 id="æŸ¥çœ‹å†å²æäº¤"><a href="#æŸ¥çœ‹å†å²æäº¤" class="headerlink" title="æŸ¥çœ‹å†å²æäº¤"></a>æŸ¥çœ‹å†å²æäº¤</h2><ul>
<li><p>æ˜¾ç¤ºæäº¤æ—¥å¿—</p>
<blockquote>
<p><code>git log </code></p>
</blockquote>
</li>
<li><p> æ˜¾ç¤º1è¡Œæ—¥å¿— -nä¸ºnè¡Œ git log -5</p>
<blockquote>
<p><code>git log -1</code></p>
</blockquote>
</li>
<li><p>æ˜¾ç¤ºæäº¤æ—¥å¿—åŠç›¸å…³å˜åŠ¨æ–‡ä»¶</p>
<blockquote>
<p><code>git log --stat </code></p>
</blockquote>
</li>
<li><p>å¯æŸ¥çœ‹è¯¥æ–‡ä»¶ä»¥å‰æ¯ä¸€æ¬¡pushçš„ä¿®æ”¹å†…å®¹ï¼‰  </p>
<blockquote>
<p><code>git log -p + xxx(æ–‡ä»¶å)</code></p>
</blockquote>
</li>
<li><p>åªæŸ¥çœ‹è¯¥æ–‡ä»¶å½“å‰è¿™ä¸€æ¬¡çš„pushå†…å®¹ï¼‰</p>
<blockquote>
<p><code>git log - p -1 + xxx(æ–‡ä»¶å</code></p>
</blockquote>
</li>
<li><p>æ˜¾ç¤ºHEADæäº¤æ—¥å¿—</p>
<blockquote>
<p><code>git show HEAD </code></p>
</blockquote>
</li>
<li><p>æ˜¾ç¤ºæŸä¸ªæäº¤çš„è¯¦ç»†å†…å®¹</p>
<blockquote>
<p><code>git show dfb02e6e4f2f7b573337763e5c0013802e392818 </code></p>
</blockquote>
</li>
<li><p>æ˜¾ç¤ºå·²å­˜åœ¨çš„tag</p>
<blockquote>
<p><code>git tag</code></p>
</blockquote>
</li>
<li><p>å¢åŠ v2.0çš„tag</p>
<blockquote>
<p><code>git tag -a v2.0  -m &#39;xxx&#39;  </code></p>
</blockquote>
</li>
<li><p>æ˜¾ç¤ºv2.0çš„æ—¥å¿—åŠè¯¦ç»†å†…å®¹</p>
<blockquote>
<p><code>git show v2.0 </code></p>
</blockquote>
</li>
<li><p>æ˜¾ç¤ºv2.0çš„æ—¥å¿—</p>
<blockquote>
<p><code>git log v2.0  </code></p>
</blockquote>
</li>
<li><p>æ˜¾ç¤ºæ‰€æœ‰æœªæ·»åŠ è‡³indexçš„å˜æ›´</p>
<blockquote>
<p><code>git diff </code></p>
</blockquote>
</li>
<li><p>æ˜¾ç¤ºæ‰€æœ‰å·²æ·»åŠ indexä½†è¿˜æœªcommitçš„å˜æ›´</p>
<blockquote>
<p><code>git diff --cached </code></p>
</blockquote>
</li>
</ul>
<h2 id="æ’¤é”€"><a href="#æ’¤é”€" class="headerlink" title="æ’¤é”€"></a>æ’¤é”€</h2><ul>
<li><p>æ’¤é”€ add è¿‡çš„æ–‡ä»¶ xxxï¼ˆæŒ‡å®šæ–‡ä»¶åï¼‰</p>
<blockquote>
<p><code>git reset HEAR &quot;xxx&quot; </code></p>
</blockquote>
</li>
<li><p> æ’¤é”€ä¸Šä¸€æ¬¡ add è¿‡çš„æ‰€æœ‰æ–‡ä»¶</p>
<blockquote>
<p><code>git reset HEAR </code></p>
</blockquote>
</li>
<li><p>æ”¾å¼ƒå•ä¸ªçš„æ–‡ä»¶ä¿®æ”¹</p>
<blockquote>
<p><code>git checkout -- xxx</code></p>
</blockquote>
</li>
<li><p> æ”¾å¼ƒæ‰€æœ‰çš„æ–‡ä»¶ä¿®æ”¹</p>
<blockquote>
<p><code>git checkout .</code></p>
</blockquote>
</li>
</ul>
<h2 id="åˆ†æ”¯ä¸æ ‡ç­¾"><a href="#åˆ†æ”¯ä¸æ ‡ç­¾" class="headerlink" title="åˆ†æ”¯ä¸æ ‡ç­¾"></a>åˆ†æ”¯ä¸æ ‡ç­¾</h2><ul>
<li><p>æ˜¾ç¤ºæœ¬åœ°æ‰€æœ‰åˆ†æ”¯</p>
<blockquote>
<p><code>git branch</code></p>
</blockquote>
</li>
<li><p>æ˜¾ç¤ºè¿œç¨‹ã€æœ¬åœ°æ‰€æœ‰åˆ†æ”¯</p>
<blockquote>
<p><code>git branch -a</code></p>
</blockquote>
</li>
<li><p>åˆ‡æ¢è‡³æŒ‡å®šåˆ†æ”¯ä¸‹</p>
<blockquote>
<p><code>git checkout &quot;xxx&quot;</code></p>
</blockquote>
</li>
<li><p>åˆ›å»ºæ–°çš„åˆ†æ”¯</p>
<blockquote>
<p><code>git branch â€xxxâ€œ   xxxä¸ºæ–°çš„åˆ†æ”¯å</code></p>
</blockquote>
</li>
<li><p>åˆ›å»ºæ–°çš„åˆ†æ”¯å¹¶åˆ‡æ¢è‡³å½“å‰æ–°å»ºçš„åˆ†æ”¯ä¸‹</p>
<blockquote>
<p><code>git check -b &quot;xxx&quot;</code></p>
</blockquote>
</li>
<li><p>åˆ é™¤æŒ‡å®šåˆ†æ”¯</p>
<blockquote>
<p><code>git branch -d &quot;xxx&quot;</code></p>
</blockquote>
</li>
<li><p>å¼ºåˆ¶åˆ é™¤æŒ‡å®šåˆ†æ”¯</p>
<blockquote>
<p><code>git branch -D &quot;xxx&quot;</code></p>
</blockquote>
</li>
<li><p>åˆ é™¤tag</p>
<blockquote>
<p><code>git tag -d &quot;xxx&quot;</code></p>
</blockquote>
</li>
<li><p>æ¸…é™¤æœ¬åœ°ç¼“å­˜åˆ†æ”¯</p>
<blockquote>
<p><code>git remote prune origin</code></p>
</blockquote>
</li>
</ul>
<h2 id="åˆå¹¶å·²è¡åˆ"><a href="#åˆå¹¶å·²è¡åˆ" class="headerlink" title="åˆå¹¶å·²è¡åˆ"></a>åˆå¹¶å·²è¡åˆ</h2><ul>
<li><p>åˆå¹¶è¿œç¨‹masteråˆ†æ”¯è‡³å½“å‰åˆ†æ”¯</p>
<blockquote>
<p><code>git merge origin/master </code></p>
</blockquote>
</li>
<li><p>åˆå¹¶æäº¤ff44785404a8eçš„ä¿®æ”¹</p>
<blockquote>
<p><code>git cherry-pick &quot;ff44785404a8e&quot;</code></p>
</blockquote>
</li>
<li><p>å°†å½“å‰åˆ†æ”¯pushåˆ°è¿œç¨‹masteråˆ†æ”¯</p>
<blockquote>
<p><code>git push origin master </code></p>
</blockquote>
</li>
<li><p>æŠŠæ‰€æœ‰æœ¬åœ°tagsæ¨é€åˆ°è¿œç¨‹ä»“åº“</p>
<blockquote>
<p><code>git push --tags</code></p>
</blockquote>
</li>
<li><p>è·å–æ‰€æœ‰è¿œç¨‹åˆ†æ”¯ï¼ˆä¸æ›´æ–°æœ¬åœ°åˆ†æ”¯ï¼‰</p>
<blockquote>
<p><code>git fetch </code></p>
</blockquote>
</li>
<li><p> è·å–æ‰€æœ‰åŸåˆ›åˆ†æ”¯å¹¶æ¸…é™¤æœåŠ¡å™¨ä¸Šå·²åˆ æ‰çš„åˆ†æ”¯</p>
<blockquote>
<p><code>git fetch --prune </code></p>
</blockquote>
</li>
<li><p>è·å–è¿œç¨‹åˆ†æ”¯masterå¹¶mergeåˆ°å½“å‰åˆ†æ”¯</p>
<blockquote>
<p><code>git pull origin master </code></p>
</blockquote>
</li>
<li><p>é‡å‘½åæ–‡ä»¶READMEä¸ºREADME2</p>
<blockquote>
<p><code>git mv README README2</code></p>
</blockquote>
</li>
<li><p>å°†å½“å‰ç‰ˆæœ¬é‡ç½®ä¸ºHEADï¼ˆé€šå¸¸ç”¨äºmergeå¤±è´¥å›é€€ï¼‰</p>
<blockquote>
<p><code>git reset --hard HEAD </code></p>
</blockquote>
</li>
</ul>
<h2 id="æš‚å­˜"><a href="#æš‚å­˜" class="headerlink" title="æš‚å­˜"></a>æš‚å­˜</h2><ul>
<li><p>æš‚å­˜å½“å‰ä¿®æ”¹ï¼Œå°†æ‰€æœ‰è‡³ä¸ºHEADçŠ¶æ€</p>
<blockquote>
<p><code>git stash </code></p>
</blockquote>
</li>
<li><p> æŸ¥çœ‹æ‰€æœ‰æš‚å­˜</p>
<blockquote>
<p><code>git stash list</code></p>
</blockquote>
</li>
<li><p>æ¢å¤æš‚å­˜æ–‡ä»¶</p>
<blockquote>
<p><code>git stash pop </code></p>
</blockquote>
</li>
</ul>
<h2 id="æ“ä½œè¿œç¨‹"><a href="#æ“ä½œè¿œç¨‹" class="headerlink" title="æ“ä½œè¿œç¨‹"></a>æ“ä½œè¿œç¨‹</h2><ul>
<li><p>æœ¬åœ°åˆ†æ”¯æ¨é€åˆ°è¿œç¨‹ä»“åº“</p>
<blockquote>
<p><code>git push origin master </code></p>
</blockquote>
</li>
<li><p>-ué€‰é¡¹æŒ‡å®šä¸€ä¸ªé»˜è®¤ä¸»æœº</p>
<blockquote>
<p><code>git push -u origin</code></p>
</blockquote>
</li>
<li><p>ä¸ç®¡æ˜¯å¦å­˜åœ¨å¯¹åº”çš„è¿œç¨‹åˆ†æ”¯ï¼Œå°†æœ¬åœ°çš„æ‰€æœ‰åˆ†æ”¯éƒ½æ¨é€åˆ°è¿œç¨‹ä¸»æœº</p>
<blockquote>
<p><code>git push --all origin </code></p>
</blockquote>
</li>
</ul>
]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>TouchBarä¸­è°ƒèŠ‚éŸ³é‡å’Œäº®åº¦æ¶ˆå¤±</title>
    <url>/relaxed/TouchBar%E4%B8%AD%E8%B0%83%E8%8A%82%E9%9F%B3%E9%87%8F%E5%92%8C%E4%BA%AE%E5%BA%A6%E6%B6%88%E5%A4%B1/</url>
    <content><![CDATA[<h2 id="æ‰“å¼€-Terminalï¼Œè¿è¡Œâ€killall-ControlStripâ€œï¼Œå°±å¯ä»¥äº†"><a href="#æ‰“å¼€-Terminalï¼Œè¿è¡Œâ€killall-ControlStripâ€œï¼Œå°±å¯ä»¥äº†" class="headerlink" title="æ‰“å¼€ Terminalï¼Œè¿è¡Œâ€killall ControlStripâ€œï¼Œå°±å¯ä»¥äº†"></a>æ‰“å¼€ Terminalï¼Œè¿è¡Œâ€killall ControlStripâ€œï¼Œå°±å¯ä»¥äº†</h2><h3 id="å¦‚æœè§‰å¾—æ­¤æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼ŒğŸ‘ğŸ»è¯·ç‚¹ä¸ªèµğŸ‘ğŸ»"><a href="#å¦‚æœè§‰å¾—æ­¤æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼ŒğŸ‘ğŸ»è¯·ç‚¹ä¸ªèµğŸ‘ğŸ»" class="headerlink" title="å¦‚æœè§‰å¾—æ­¤æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼ŒğŸ‘ğŸ»è¯·ç‚¹ä¸ªèµğŸ‘ğŸ»"></a><font color=#9dc2af>å¦‚æœè§‰å¾—æ­¤æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼ŒğŸ‘ğŸ»è¯·ç‚¹ä¸ªèµğŸ‘ğŸ»</font></h3>]]></content>
      <tags>
        <tag>Mac</tag>
      </tags>
  </entry>
  <entry>
    <title>Markdown è¯­æ³•</title>
    <url>/relaxed/markdown-grammar/</url>
    <content><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p> &ensp; Markdownè¯­æ³•çš„åŸºæœ¬ä½¿ç”¨</p>
<h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><p><img src="https://s3.bmp.ovh/imgs/2022/03/5e25d102468382c1.jpg"></p>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>MarkDownåŸºç¡€è¯­æ³•ä½¿ç”¨å‚è€ƒ</p>
<h2 id="æ ‡é¢˜"><a href="#æ ‡é¢˜" class="headerlink" title="æ ‡é¢˜"></a>æ ‡é¢˜</h2><ul>
<li><p>è¯­æ³•<br>ä¸€çº§æ ‡é¢˜ç”¨ä¸€ä¸ª#ï¼ŒäºŒçº§æ ‡é¢˜## â€¦.æœ€å¤šå±•ç¤ºå…­çº§æ ‡é¢˜</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># ä¸€çº§æ ‡é¢˜</span><br><span class="line">## äºŒçº§æ ‡é¢˜</span><br><span class="line">### ä¸‰çº§æ ‡é¢˜</span><br><span class="line">#### å››çº§æ ‡é¢˜</span><br><span class="line">###### äº”çº§æ ‡é¢˜</span><br><span class="line">####### å…­çº§æ ‡é¢˜</span><br></pre></td></tr></table></figure></li>
<li><p>æ•ˆæœ</p>
<h1 id="ä¸€çº§æ ‡é¢˜"><a href="#ä¸€çº§æ ‡é¢˜" class="headerlink" title="ä¸€çº§æ ‡é¢˜"></a>ä¸€çº§æ ‡é¢˜</h1><h2 id="äºŒçº§æ ‡é¢˜"><a href="#äºŒçº§æ ‡é¢˜" class="headerlink" title="äºŒçº§æ ‡é¢˜"></a>äºŒçº§æ ‡é¢˜</h2><h3 id="ä¸‰çº§æ ‡é¢˜"><a href="#ä¸‰çº§æ ‡é¢˜" class="headerlink" title="ä¸‰çº§æ ‡é¢˜"></a>ä¸‰çº§æ ‡é¢˜</h3><h4 id="å››çº§æ ‡é¢˜"><a href="#å››çº§æ ‡é¢˜" class="headerlink" title="å››çº§æ ‡é¢˜"></a>å››çº§æ ‡é¢˜</h4><h5 id="äº”çº§æ ‡é¢˜"><a href="#äº”çº§æ ‡é¢˜" class="headerlink" title="äº”çº§æ ‡é¢˜"></a>äº”çº§æ ‡é¢˜</h5><h6 id="å…­çº§æ ‡é¢˜"><a href="#å…­çº§æ ‡é¢˜" class="headerlink" title="å…­çº§æ ‡é¢˜"></a>å…­çº§æ ‡é¢˜</h6></li>
</ul>
<h2 id="å­—ä½“"><a href="#å­—ä½“" class="headerlink" title="å­—ä½“"></a>å­—ä½“</h2><ul>
<li><p>åŠ ç²—</p>
<ul>
<li>è¯­æ³•<br> è¦åŠ ç²—çš„æ–‡æœ¬å‰åç”¨ä¸¤ä¸ª ** ç¬¦å·åŒ…è£¹èµ·æ¥</li>
<li>æ•ˆæœ<br> <strong>æˆ‘æ˜¯åŠ ç²—åçš„å­—ä½“</strong></li>
</ul>
</li>
<li><p>æ–œä½“</p>
<ul>
<li>è¯­æ³•<br> è¦å€¾æ–œçš„æ–‡æœ¬å‰åç”¨ä¸€ä¸ª * ç¬¦å·åŒ…è£¹èµ·æ¥</li>
<li>æ•ˆæœ</li>
<li>æˆ‘æ˜¯å€¾æ–œåçš„å­—ä½“*</li>
</ul>
</li>
<li><p>æ–œä½“&amp;åŠ ç²—<br>*è¯­æ³•<br>  è¦å€¾æ–œå¹¶ä¸”åŠ ç²—çš„æ–‡æœ¬å‰åç”¨ä¸‰ä¸ª ***  ç¬¦å·åŒ…è£¹èµ·æ¥<br>*æ•ˆæœ</p>
</li>
<li><p><strong>æˆ‘æ˜¯å€¾æ–œå¹¶ä¸”åŠ ç²—åçš„å­—ä½“</strong>*</p>
</li>
<li><p>åˆ é™¤çº¿</p>
<ul>
<li>è¯­æ³•<br> è¦åŠ åˆ é™¤çº¿çš„æ–‡æœ¬å·¦å³åˆ†åˆ«ç”¨ä¸¤ä¸ª ~~ ç¬¦å·åŒ…èµ·æ¥</li>
<li>æ•ˆæœ<br><del>æˆ‘æ˜¯æ·»åŠ åˆ é™¤çº¿çš„å­—ä½“</del></li>
</ul>
</li>
</ul>
<h2 id="æ®µè½"><a href="#æ®µè½" class="headerlink" title="æ®µè½"></a>æ®µè½</h2><ul>
<li><p>ç©ºæ ¼</p>
<ul>
<li>è¯­æ³•<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ’å…¥ä¸€ä¸ªç©ºæ ¼ &amp;nbsp;   </span><br><span class="line">æ’å…¥ä¸¤ä¸ªç©ºæ ¼ &amp;ensp;  </span><br><span class="line">æ’å…¥å››ä¸ªç©ºæ ¼ &amp;emsp;   </span><br></pre></td></tr></table></figure>
æˆ–è€…ä½¿ç”¨å…¨è§’ç©ºæ ¼ã€‚å³ï¼šåœ¨å…¨è§’è¾“å…¥çŠ¶æ€ä¸‹ç›´æ¥ä½¿ç”¨ç©ºæ ¼é”®å°±okäº†</li>
<li>æ•ˆæœ<br>&nbsp;   æ’å…¥ä¸€ä¸ªç©ºæ ¼æ–‡æœ¬<br>&ensp;   æ’å…¥ä¸¤ä¸ªç©ºæ ¼æ–‡æœ¬<br>&emsp;   æ’å…¥å››ä¸ªç©ºæ ¼æ–‡æœ¬<br>ã€€ã€€å…¨è§’æŒ‰äº†ä¸¤ä¸ªç©ºæ ¼æ–‡æœ¬ğŸ˜</li>
</ul>
</li>
<li><p>æ¢è¡Œ</p>
<ul>
<li>è¯­æ³•<br>ä½¿ç”¨ HTML çš„Â <code>&lt;br&gt;</code>Â æ ‡ç­¾æ¥å®ç°æ¢è¡Œã€‚</li>
<li>æ•ˆæœ<br>æˆ‘åœ¨è¿™é‡Œéœ€è¦æ¢è¡Œå•¦<br>ç²¾å½©å†…å®¹åœ¨ä»åœ¨ç»§ç»­â€¦</li>
</ul>
</li>
</ul>
<h2 id="å—å¼•ç”¨"><a href="#å—å¼•ç”¨" class="headerlink" title="å—å¼•ç”¨"></a>å—å¼•ç”¨</h2><ul>
<li><p>å•ä¸ªæ®µè½å—å¼•ç”¨</p>
<ul>
<li>è¯­æ³•<br>è¦åˆ›å»ºå•ä¸ªæ®µè½å—å¼•ç”¨ï¼Œè¯·åœ¨æ®µè½å‰æ·»åŠ ä¸€ä¸ª &gt; ç¬¦å·ã€‚</li>
<li>æ•ˆæœ<blockquote>
<p>æˆ‘æ˜¯å•ä¸ªæ®µè½å¼•ç”¨</p>
</blockquote>
</li>
</ul>
</li>
<li><p>å¤šä¸ªæ®µè½å—å¼•ç”¨</p>
<ul>
<li>è¯­æ³•<br> è¦åˆ›å»ºå•ä¸ªæ®µè½å—å¼•ç”¨ï¼Œè¯·åœ¨æ®µè½å‰ä¸æ®µè½ä¹‹é—´æ·»åŠ  &gt; ç¬¦å·ã€‚</li>
<li>æ•ˆæœ<blockquote>
<p>æˆ‘æ˜¯æ®µè½ä¸€</p>
<p>æˆ‘æ˜¯æ®µè½äºŒ</p>
</blockquote>
</li>
</ul>
</li>
<li><p>åµŒå¥—å—å¼•ç”¨</p>
</li>
<li><p>è¯­æ³•<br> åœ¨è¦åµŒå¥—çš„æ®µè½å‰æ·»åŠ ä¸€ä¸ª &gt;&gt; ç¬¦å·ã€‚</p>
</li>
<li><p>æ•ˆæœ</p>
<blockquote>
<p>æˆ‘æ˜¯æ®µè½ä¸€</p>
<blockquote>
<p>æˆ‘æ˜¯æ®µè½äºŒå¹¶ä¸”éœ€è¦åµŒå¥—å¼•ç”¨</p>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>æ— é™åµŒå¥—å¼•ç”¨â€¦</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</li>
</ul>
<h2 id="åˆ—è¡¨"><a href="#åˆ—è¡¨" class="headerlink" title="åˆ—è¡¨"></a>åˆ—è¡¨</h2><ul>
<li><p>æœ‰åºåˆ—è¡¨</p>
<ul>
<li><p>è¯­æ³•<br> åˆ—è¡¨é¡¹å‰æ·»åŠ æ•°å­—å¹¶ç´§è·Ÿä¸€ä¸ªè‹±æ–‡å¥ç‚¹ 1. 2. 3. ç­‰ç­‰ â€¦</p>
</li>
<li><p>æ•ˆæœ</p>
</li>
</ul>
<p>1.æœ‰åºåˆ—è¡¨<br>2.æœ‰åºåˆ—è¡¨<br>3.æœ‰åºåˆ—è¡¨<br>â€¦</p>
</li>
<li><p>æ— åºåˆ—è¡¨<br>ä¸ºäº†å…¼å®¹ï¼Œè¯·ä¸è¦åœ¨åŒä¸€ä¸ªåˆ—è¡¨ä¸­æ··ç”¨ä¸åŒçš„åˆ†éš”ç¬¦ï¼Œæœ€å¥½é€‰å®šä¸€ç§åˆ†éš”ç¬¦ä½¿ç”¨</p>
<ul>
<li>è¯­æ³•<br>æ— åºåˆ—è¡¨ç”¨ - + * ä»»æ„ä¸€ç§éƒ½å¯ä»¥</li>
<li>æ•ˆæœ<ul>
<li>æ— åºåˆ—è¡¨</li>
<li>æ— åºåˆ—è¡¨</li>
<li>æ— åºåˆ—è¡¨</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><ul>
<li><p>ä»£ç å—é«˜äº®</p>
<ul>
<li>è¯­æ³•</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ï¼ˆ```ï¼‰java</span><br><span class="line">  è¿™ä¸ªå†™ä»£ç å—</span><br><span class="line">  æ³¨æ„ï¼šï¼ˆ```ï¼‰è¿™ä¸ªå†™æ³•æ˜¯é˜²æ­¢ç¬¦å·è¢«è½¬ä¹‰ï¼Œæ­£å¸¸å†™å»æ‰ï¼ˆï¼‰åªå†™ ``` å°±å¥½äº†</span><br><span class="line">ï¼ˆ```ï¼‰</span><br></pre></td></tr></table></figure>
<ul>
<li>æ•ˆæœ<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String args[])</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello World!&quot;</span>);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>å•è¡Œä»£ç å—</p>
<ul>
<li>è¯­æ³•<br>å•è¡Œä»£ç å—ä½¿ç”¨ `  `åŒ…è£¹</li>
<li>æ•ˆæœ<br> <code> System.out.println(&quot;Hello World!&quot;); </code></li>
</ul>
</li>
</ul>
<h2 id="å›¾ç‰‡"><a href="#å›¾ç‰‡" class="headerlink" title="å›¾ç‰‡"></a>å›¾ç‰‡</h2><ul>
<li>è¯­æ³•<br>[å›¾ç‰‡ä¸Šä¼ ä¸­â€¦(image-9df155-1642153968831)]<br>å›¾ç‰‡altå°±æ˜¯æ˜¾ç¤ºåœ¨å›¾ç‰‡ä¸‹é¢çš„æ–‡å­—ï¼Œç›¸å½“äºå¯¹å›¾ç‰‡å†…å®¹çš„è§£é‡Šã€‚</li>
<li>æ•ˆæœ<br><img src="https://s3.bmp.ovh/imgs/2022/03/3c7eea0313d87901.jpeg"></li>
</ul>
<h2 id="åˆ†å‰²çº¿"><a href="#åˆ†å‰²çº¿" class="headerlink" title="åˆ†å‰²çº¿"></a>åˆ†å‰²çº¿</h2><ul>
<li>è¯­æ³•<br>ä¸ºäº†å…¼å®¹æ€§ï¼Œè¯·åœ¨åˆ†éš”çº¿çš„å‰åå‡æ·»åŠ ç©ºç™½è¡Œ<br>ä¸‰ä¸ªä»¥ä¸Š â€” æˆ– ***</li>
<li>æ•ˆæœ</li>
</ul>
<hr>
<hr>
<hr>
<hr>
<h2 id="è¶…é“¾æ¥"><a href="#è¶…é“¾æ¥" class="headerlink" title="è¶…é“¾æ¥"></a>è¶…é“¾æ¥</h2><ul>
<li>è¯­æ³•<br>è¦åˆ›å»ºé“¾æ¥ï¼Œè¯·å°†é“¾æ¥æ–‡æœ¬æ‹¬åœ¨æ–¹æ‹¬å·ï¼ˆä¾‹å¦‚ [Duck Duck Go]ï¼‰ä¸­ï¼Œåé¢ç´§è·Ÿç€æ‹¬åœ¨åœ†æ‹¬å·ä¸­çš„ URLï¼ˆä¾‹å¦‚ (<a href="https://duckduckgo.com/">https://duckduckgo.com</a>) ï¼‰ã€‚</li>
<li>æ•ˆæœ<br>My favorite search engine is <a href="https://duckduckgo.com/">Duck Duck Go</a>.</li>
</ul>
<h2 id="æµç¨‹å›¾"><a href="#æµç¨‹å›¾" class="headerlink" title="æµç¨‹å›¾"></a>æµç¨‹å›¾</h2><p>å› ç®€ä¹¦ä¸æ”¯æŒæµç¨‹å›¾ï¼Œå¯ä»¥å‚è€ƒï¼š<br><a href="https://www.runoob.com/markdown/md-advance.html">https://www.runoob.com/markdown/md-advance.html</a></p>
<h2 id="è¡¨æ ¼"><a href="#è¡¨æ ¼" class="headerlink" title="è¡¨æ ¼"></a>è¡¨æ ¼</h2><ul>
<li>è¯­æ³•<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">| è¡¨å¤´ | è¡¨å¤´|</span><br><span class="line">| --- | --- |</span><br><span class="line">| å†…å®¹ | å†…å®¹ |</span><br><span class="line">| å†…å®¹ | å†…å®¹ |</span><br></pre></td></tr></table></figure></li>
<li>æ•ˆæœ<table>
<thead>
<tr>
<th>è¡¨å¤´</th>
<th>è¡¨å¤´</th>
</tr>
</thead>
<tbody><tr>
<td>å†…å®¹</td>
<td>å†…å®¹</td>
</tr>
<tr>
<td>å†…å®¹</td>
<td>å†…å®¹</td>
</tr>
</tbody></table>
</li>
<li>å¯¹é½æ–¹å¼<ul>
<li>è¯­æ³•<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">| å·¦å¯¹é½ | å³å¯¹é½ | å±…ä¸­å¯¹é½ |</span><br><span class="line">| :-----| ----: | :----: |</span><br><span class="line">| å†…å®¹ | å†…å®¹ | å†…å®¹ |</span><br><span class="line">| å†…å®¹ | å†…å®¹ | å†…å®¹ |</span><br></pre></td></tr></table></figure></li>
<li>æ•ˆæœ<table>
<thead>
<tr>
<th align="left">å·¦å¯¹é½</th>
<th align="right">å³å¯¹é½</th>
<th align="center">å±…ä¸­å¯¹é½</th>
</tr>
</thead>
<tbody><tr>
<td align="left">å†…å®¹</td>
<td align="right">å†…å®¹</td>
<td align="center">å†…å®¹</td>
</tr>
<tr>
<td align="left">å†…å®¹</td>
<td align="right">å†…å®¹</td>
<td align="center">å†…å®¹</td>
</tr>
</tbody></table>
<h2 id="ç½‘å€ã€ç”µå­é‚®ä»¶åœ°å€"><a href="#ç½‘å€ã€ç”µå­é‚®ä»¶åœ°å€" class="headerlink" title="ç½‘å€ã€ç”µå­é‚®ä»¶åœ°å€"></a>ç½‘å€ã€ç”µå­é‚®ä»¶åœ°å€</h2></li>
</ul>
</li>
<li>è¯­æ³•<br> å°† URL æˆ–ç”µå­é‚®ä»¶åœ°å€æ‹¬åœ¨&lt;&gt;é‡Œ</li>
<li>æ•ˆæœ<br><a href="https://www.google.com.hk/">https://www.google.com.hk/</a><br><a href="mailto:&#116;&#101;&#x73;&#x74;&#64;&#103;&#109;&#x61;&#105;&#x6c;&#x2e;&#99;&#111;&#109;">&#116;&#101;&#x73;&#x74;&#64;&#103;&#109;&#x61;&#105;&#x6c;&#x2e;&#99;&#111;&#109;</a></li>
</ul>
<h2 id="è½¬ä¹‰å­—ç¬¦"><a href="#è½¬ä¹‰å­—ç¬¦" class="headerlink" title="è½¬ä¹‰å­—ç¬¦"></a>è½¬ä¹‰å­—ç¬¦</h2><p>ä»¥ä¸‹åˆ—å‡ºçš„å­—ç¬¦éƒ½å¯ä»¥é€šè¿‡ä½¿ç”¨åæ–œæ å­—ç¬¦ä»è€Œè¾¾åˆ°è½¬ä¹‰ç›®çš„ã€‚<br>å­—ç¬¦|åç§°<br>â€“|â€“<br>| \ | åæ–œæ <br>| * | æ˜Ÿå·ï¼ˆasteriskï¼‰ |<br>| _ | ä¸‹åˆ’çº¿ï¼ˆunderscoreï¼‰ |<br>| { } | èŠ±æ‹¬å·ï¼ˆcurly bracesï¼‰ |<br>| [ ] | æ–¹æ‹¬å·ï¼ˆbracketsï¼‰ |<br>| &lt; &gt; | angle brackets |<br>| ( ) | åœ†æ‹¬å·æˆ–æ‹¬å·ï¼ˆparenthesesï¼‰ |<br>| # | äº•å·ï¼ˆpound signï¼‰ |<br>| + | åŠ å·ï¼ˆplus signï¼‰ |<br>| - | å‡å·ï¼ˆminus signï¼‰ (ä¹Ÿå«è¿å­—ç¬¦ hyphen) |<br>| . | å¥ç‚¹ï¼ˆdotï¼‰ |<br>| ! | æ„Ÿå¹å·ï¼ˆexclamation markï¼‰ |</p>
]]></content>
      <categories>
        <category>Markdown</category>
      </categories>
      <tags>
        <tag>Markdown</tag>
      </tags>
  </entry>
  <entry>
    <title>EventBusä½¿ç”¨æ–¹å¼</title>
    <url>/relaxed/EventBus%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><ul>
<li>Androidå¼€å‘ä¸­ EventBusçš„ä½¿ç”¨<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><a href="https://s1.ax1x.com/2022/05/09/OGINDg.png"><img src="https://s1.ax1x.com/2022/05/09/OGINDg.png" alt="ç¤ºæ„å›¾.png"></a><h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1></li>
<li>ä¸€å¥— <font color= "#c85863" >Android / Java</font> äº‹ä»¶è®¢é˜… / å‘å¸ƒæ¡†æ¶ï¼Œç”±greenrobotå›¢é˜Ÿå¼€æºï¼Œå®ƒçš„å‡ºç°ç®€åŒ–äº†åº”ç”¨ç¨‹åºå†…å„ä¸ªç»„ä»¶ä¹‹é—´è¿›è¡Œé€šä¿¡çš„å¤æ‚åº¦ï¼Œå°¤å…¶æ˜¯ç¢ç‰‡ä¹‹é—´è¿›è¡Œé€šä¿¡çš„é—®é¢˜ã€‚</li>
</ul>
<h1 id="ä½¿ç”¨æ–¹å¼"><a href="#ä½¿ç”¨æ–¹å¼" class="headerlink" title="ä½¿ç”¨æ–¹å¼"></a>ä½¿ç”¨æ–¹å¼</h1><h2 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">eventbus : <span class="string">&#x27;org.greenrobot:eventbus:3.2.0&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="æ³¨å†Œã€æ³¨é”€"><a href="#æ³¨å†Œã€æ³¨é”€" class="headerlink" title="æ³¨å†Œã€æ³¨é”€"></a>æ³¨å†Œã€æ³¨é”€</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onStart</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onStart();</span><br><span class="line">    EventBus.getDefault().register(<span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onDestroy</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">super</span>.onDestroy();</span><br><span class="line">     EventBus.getDefault().unregister(<span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="è®¢é˜…è€…"><a href="#è®¢é˜…è€…" class="headerlink" title="è®¢é˜…è€…"></a>è®¢é˜…è€…</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Subscribe(threadMode = ThreadMode.MAIN)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onUpDateEvent</span><span class="params">(BaseMessageEvent messageEvent )</span>&#123;</span><br><span class="line">    <span class="comment">//do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å‘å¸ƒäº‹ä»¶"><a href="#å‘å¸ƒäº‹ä»¶" class="headerlink" title="å‘å¸ƒäº‹ä»¶"></a>å‘å¸ƒäº‹ä»¶</h2><h3 id="æ™®é€šäº‹ä»¶"><a href="#æ™®é€šäº‹ä»¶" class="headerlink" title="æ™®é€šäº‹ä»¶"></a>æ™®é€šäº‹ä»¶</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">EventBus.getDefault().post(<span class="keyword">new</span> <span class="title class_">BaseMessageEvent</span>(<span class="string">&quot;&quot;</span>))</span><br></pre></td></tr></table></figure>
<h3 id="ç²˜æ€§äº‹ä»¶"><a href="#ç²˜æ€§äº‹ä»¶" class="headerlink" title="ç²˜æ€§äº‹ä»¶"></a>ç²˜æ€§äº‹ä»¶</h3><ul>
<li>é»æ€§äº‹ä»¶ï¼Œå°±æ˜¯æŒ‡å‘é€äº†è¯¥äº‹ä»¶ä¹‹åå†è®¢é˜…è€…ä¾ç„¶èƒ½å¤Ÿæ¥æ”¶åˆ°çš„äº‹ä»¶ã€‚ä½¿ç”¨é»æ€§äº‹ä»¶çš„æ—¶å€™æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦åšäº›ä¿®æ”¹ã€‚åˆ†åˆ«åœ¨å‘å¸ƒå’Œè®¢é˜…ä¸­æ¥ä½¿ç”¨ã€‚<h4 id="å‘å¸ƒ"><a href="#å‘å¸ƒ" class="headerlink" title="å‘å¸ƒ"></a>å‘å¸ƒ</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">EventBus.getDefault().postSticky(<span class="keyword">new</span> <span class="title class_">BaseMessageEvent</span>(<span class="string">&quot;&quot;</span>));</span><br></pre></td></tr></table></figure>
<h4 id="è®¢é˜…"><a href="#è®¢é˜…" class="headerlink" title="è®¢é˜…"></a>è®¢é˜…</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Subscribe(threadMode = ThreadMode.MAIN , sticky = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onUpDateEvent</span><span class="params">(BaseMessageEvent messageEvent )</span>&#123;</span><br><span class="line">    <span class="comment">//do something</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="è·å–äº‹ä»¶"><a href="#è·å–äº‹ä»¶" class="headerlink" title="è·å–äº‹ä»¶"></a>è·å–äº‹ä»¶</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">EventBus.getDefault().getStickyEvent(BaseMessageEvent.class);</span><br></pre></td></tr></table></figure>
<h4 id="ç§»é™¤äº‹ä»¶"><a href="#ç§»é™¤äº‹ä»¶" class="headerlink" title="ç§»é™¤äº‹ä»¶"></a>ç§»é™¤äº‹ä»¶</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">EventBus.getDefault().removeStickyEvent(BaseMessageEvent.class);</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="ä¼˜å…ˆçº§"><a href="#ä¼˜å…ˆçº§" class="headerlink" title="ä¼˜å…ˆçº§"></a>ä¼˜å…ˆçº§</h2><ul>
<li>å³priorityã€‚å®ƒç”¨æ¥æŒ‡å®šè®¢é˜…æ–¹æ³•çš„ä¼˜å…ˆçº§ï¼Œæ˜¯ä¸€ä¸ªæ•´æ•°ç±»å‹çš„å€¼ï¼Œé»˜è®¤æ˜¯0ï¼Œå€¼è¶Šå¤§è¡¨ç¤ºä¼˜å…ˆçº§è¶Šå¤§ã€‚åœ¨æŸä¸ªäº‹ä»¶è¢«å‘å¸ƒå‡ºæ¥çš„æ—¶å€™ï¼Œä¼˜å…ˆçº§è¾ƒé«˜çš„è®¢é˜…æ–¹æ³•ä¼šé¦–å…ˆæ¥å—åˆ°äº‹ä»¶ã€‚</li>
<li>ç‰¹åˆ«æ³¨æ„ï¼š<ul>
<li> è®¢é˜…æ–¹æ³•ï¼Œéœ€è¦ä¸threadModeä¸€è‡´ï¼Œå¹¶ä¸”ä¼˜å…ˆçº§ç•¥é«˜</li>
<li> ä¼˜å…ˆçº§ä¸ä¼šå½±å“å…·æœ‰ä¸åŒThreadModesçš„è®¢é˜…è€…çš„ä¼ é€’é¡ºåº</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Subscribe(threadMode = ThreadMode.POSTING , sticky = true, priority = 1)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onUpDateEvent</span><span class="params">(BaseMessageEvent messageEvent )</span>&#123;</span><br><span class="line">    <span class="comment">//do something</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="å–æ¶ˆäº‹ä»¶ä¼ é€’"><a href="#å–æ¶ˆäº‹ä»¶ä¼ é€’" class="headerlink" title="å–æ¶ˆäº‹ä»¶ä¼ é€’"></a>å–æ¶ˆäº‹ä»¶ä¼ é€’</h1><ul>
<li><p>äº‹ä»¶çš„ä¼˜å…ˆçº§è¶Šé«˜æ¥æ”¶çš„æ•°æ®æœ€å¿«ï¼Œæ‰€ä»¥å½“ä¼˜å…ˆçº§ä¸æƒ³åˆ†å‘äº‹ä»¶ç»™ä½çº§åˆ«çš„äº‹ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨cancelEventDelivery ï¼ˆObject eventï¼‰å–æ¶ˆäº‹ä»¶ä¼ é€’</p>
</li>
<li><p>æ³¨ï¼šå½“ä¼˜å…ˆçº§æ›´é«˜çš„æƒ³å–æ¶ˆäº‹ä»¶ä¼ é€’æ—¶ï¼Œåªæœ‰å½“threadMode = ThreadMode.POSTINGå¤„äºæ­¤çŠ¶æ€æ‰èƒ½å–æ¶ˆäº‹ä»¶ä¼ é€’æœ‰æ•ˆã€‚å…¶ä»–çº¿ç¨‹æ¨¡å‹å±æ€§ä¸è¡Œ</p>
</li>
</ul>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>EventBusåŸºæœ¬ä½¿ç”¨æ–¹å¼å°±ä»‹ç»åˆ°è¿™é‡Œï¼ŒEventBusæºç åˆ†æè¯·çœ‹ï¼š<a href="#">Post not found: EventBusåŸç†åˆ†æ EventBusæºç åˆ†æ</a></p>
]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>EventBus</tag>
      </tags>
  </entry>
  <entry>
    <title>Handler-å†…å­˜æ³„æ¼è§£å†³æ–¹æ¡ˆ</title>
    <url>/relaxed/Handler-%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><ul>
<li>Androidå¼€å‘ä¸­ï¼Œå†…å­˜æ³„æ¼æ˜¯ç»å¸¸å‘ç”Ÿçš„ï¼Œä»Šå¤©æ¥è¯¦ç»†èŠä¸€èŠHandlerä½¿ç”¨è¿‡ç¨‹ä¸­äº§ç”Ÿå†…å­˜æ³„æ¼çš„åœºæ™¯ä»¥åŠå¯¹åº”çš„è§£å†³æ–¹æ¡ˆã€‚</li>
</ul>
<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p><a href="https://s1.ax1x.com/2022/05/04/OEUUXD.png"><img src="https://s1.ax1x.com/2022/05/04/OEUUXD.png" alt="OEUUXD.png"></a></p>
<h1 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h1><ul>
<li>Androidä¸­ä½¿ç”¨Handlerå¯¼è‡´å†…å­˜æ³„æ¼åŸå› åˆ†æã€‚å½“ä¸€ä¸ªå¯¹è±¡å·²ç»ä¸å†è¢«ä½¿ç”¨æ—¶ï¼Œæœ¬è¯¥è¢«å›æ”¶ä½†å´å› ä¸ºæœ‰å¦å¤–ä¸€ä¸ªæ­£åœ¨ä½¿ç”¨çš„å¯¹è±¡æŒæœ‰å®ƒçš„å¼•ç”¨ä»è€Œå¯¼è‡´å®ƒä¸èƒ½è¢«å›æ”¶ï¼Œå¯¼è‡´äº†å†…å­˜æ³„æ¼ã€‚</li>
</ul>
<h1 id="åŸå› è¯¦è§£"><a href="#åŸå› è¯¦è§£" class="headerlink" title="åŸå› è¯¦è§£"></a>åŸå› è¯¦è§£</h1><ul>
<li>åœ¨Handleræ¶ˆæ¯é˜Ÿåˆ—è¿˜æœ‰æœªå¤„ç†çš„æ¶ˆæ¯ / æ­£åœ¨å¤„ç†æ¶ˆæ¯æ—¶ï¼Œæ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„MessageæŒæœ‰Handlerå®ä¾‹çš„å¼•ç”¨ï¼Œç”±äºHandler = éé™æ€å†…éƒ¨ç±» &amp; åŒ¿åå†…éƒ¨ç±»åˆé»˜è®¤æŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ã€‚å¦‚å›¾</li>
</ul>
<p><a href="https://s1.ax1x.com/2022/05/04/OE88YT.png"><img src="https://s1.ax1x.com/2022/05/04/OE88YT.png" alt="ç¤ºä¾‹1.png"></a></p>
<h1 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h1><ul>
<li><p>é™æ€å†…éƒ¨ç±»+å¼±å¼•ç”¨</p>
</li>
<li><p>é™æ€å†…éƒ¨ç±» ä¸é»˜è®¤æŒæœ‰å¤–éƒ¨ç±»çš„å¼•ç”¨ï¼Œä»è€Œä½¿å¾— â€œæœªè¢«å¤„ç†&amp;æ­£å¤„ç†çš„æ¶ˆæ¯ -&gt; Handlerå®ä¾‹ -&gt; å¤–éƒ¨ç±»â€çš„å¼•ç”¨å…³ç³»ä¸å¤å­˜åœ¨ã€‚</p>
</li>
<li><p>ä½¿ç”¨WeakReferenceå¼±å¼•ç”¨æŒæœ‰Activityå®ä¾‹çš„åŸå› ï¼šå¼±å¼•ç”¨çš„å¯¹è±¡æ‹¥æœ‰çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸã€‚åœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«ææ—¶ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜</p>
</li>
<li><p>å·¥å…·ç±»å°è£…</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.linked.business.handler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Handler;</span><br><span class="line"><span class="keyword">import</span> android.os.Looper;</span><br><span class="line"><span class="keyword">import</span> android.os.Message;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.ref.WeakReference;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ArrestLeakHandler</span> <span class="keyword">extends</span> <span class="title class_">Handler</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> WeakReference&lt;MessageHandler&gt; reference;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrestLeakHandler</span><span class="params">(MessageHandler messageHandler)</span> &#123;</span><br><span class="line">        reference = <span class="keyword">new</span> <span class="title class_">WeakReference</span>&lt;&gt;(messageHandler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ArrestLeakHandler</span><span class="params">(MessageHandler messageHandler, Looper looper)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(looper);</span><br><span class="line">        reference = <span class="keyword">new</span> <span class="title class_">WeakReference</span>&lt;&gt;(messageHandler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å¤å†™handlerMessage åšæ›´æ–°UIçš„æ“ä½œ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleMessage</span><span class="params">(Message msg)</span> &#123;</span><br><span class="line">        <span class="type">MessageHandler</span> <span class="variable">messageHandler</span> <span class="operator">=</span> reference.get();</span><br><span class="line">        <span class="keyword">if</span> (messageHandler != <span class="literal">null</span>) &#123;</span><br><span class="line">            messageHandler.handleMessage(msg);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MessageHandler</span> &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">handleMessage</span><span class="params">(Message msg)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>å…·ä½“ java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HandlerLeakActivity</span> <span class="keyword">extends</span> <span class="title class_">BaseActivity</span>&lt;ActivtyHandlerLeakBinding, BasePresenter&gt; <span class="keyword">implements</span> <span class="title class_">ArrestLeakHandler</span>.MessageHandler &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(<span class="meta">@Nullable</span> Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        initViews();</span><br><span class="line">        initHandler();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">initViews</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//å‘é€æ¶ˆæ¯A</span></span><br><span class="line">        vBinding.tvA.setOnClickListener(view -&gt; &#123;</span><br><span class="line">            <span class="type">Message</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">            msg.obj = <span class="string">&quot;æˆ‘æ˜¯æ¶ˆæ¯A&quot;</span>;</span><br><span class="line">            msg.what = <span class="number">1</span>;</span><br><span class="line">            mHandler.sendMessage(msg);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘é€æ¶ˆæ¯B</span></span><br><span class="line">        vBinding.tvB.setOnClickListener(view -&gt; &#123;</span><br><span class="line">            <span class="type">Message</span> <span class="variable">msg</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Message</span>();</span><br><span class="line">            msg.obj = <span class="string">&quot;æˆ‘æ˜¯æ¶ˆæ¯B&quot;</span>;</span><br><span class="line">            msg.what = <span class="number">2</span>;</span><br><span class="line">            mHandler.sendMessage(msg);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> BasePresenter <span class="title function_">initPresenter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onBackPressed</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onBackPressed();</span><br><span class="line">        finish();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> ArrestLeakHandler mHandler, mMainHandler;</span><br><span class="line">    HandlerThread mHandlerThread;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initHandler</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//â‘ åˆ›å»ºå­çº¿ç¨‹</span></span><br><span class="line">        mHandlerThread = <span class="keyword">new</span> <span class="title class_">HandlerThread</span>(<span class="string">&quot;handlerThread&quot;</span>);</span><br><span class="line">        <span class="comment">//â‘¡å¼€å¯çº¿ç¨‹</span></span><br><span class="line">        mHandlerThread.start();</span><br><span class="line">        <span class="comment">//â‘¢å»ºç«‹ä¸ä¸»çº¿ç¨‹å…³è”Handler</span></span><br><span class="line">        mMainHandler = <span class="keyword">new</span> <span class="title class_">ArrestLeakHandler</span>(<span class="built_in">this</span>);</span><br><span class="line">        mHandler = <span class="keyword">new</span> <span class="title class_">ArrestLeakHandler</span>(<span class="built_in">this</span>, mHandlerThread.getLooper());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleMessage</span><span class="params">(Message msg)</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> (msg.what) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> (String) msg.obj;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">1500</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                LogUtils.v(<span class="string">&quot;Handler Message---&gt;&quot;</span> + str);</span><br><span class="line">                mMainHandler.post(() -&gt; vBinding.tvShowMessage.setText(str));</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onDestroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onDestroy();</span><br><span class="line">        mHandler.removeCallbacksAndMessages(<span class="literal">null</span>);</span><br><span class="line">        mHandler = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li><p>æ³¨:å½“å¤–éƒ¨ç±»ï¼ˆActivityä¸ºä¾‹ï¼‰ç»“æŸç”Ÿå‘½å‘¨æœŸæ—¶ï¼ˆonDestroyï¼‰ï¼Œåº”å½“æ¸…é™¤Handleræ¶ˆæ¯é˜Ÿåˆ—é‡Œçš„æ‰€æœ‰æ¶ˆæ¯ï¼ˆè°ƒç”¨removeCallbacksAndMessages(null)ï¼‰æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onDestroy</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onDestroy();</span><br><span class="line">        mHandler.removeCallbacksAndMessages(<span class="literal">null</span>);</span><br><span class="line">        mHandler = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1></li>
<li><p>å½“Handleræ¶ˆæ¯é˜Ÿåˆ—ä¸­å­˜åœ¨æœªå¤„ç†æˆ–æ­£åœ¨å¤„ç†çš„æ¶ˆæ¯æ—¶ï¼Œå¹¶ä¸”å­˜åœ¨å¼•ç”¨å…³ç³»:æœªè¢«å¤„ç†&amp;æ­£å¤„ç†çš„æ¶ˆæ¯-&gt;Handlerå®ä¾‹-&gt;å¤–éƒ¨ç±»<br>å½“Handlerçš„ç”Ÿå‘½å‘¨æœŸ&gt;å¤–éƒ¨ç±»çš„ç”Ÿå‘½å‘¨æœŸæ—¶ï¼ˆå½“å¤–éƒ¨ç±»éœ€é”€æ¯æ—¶(Handleræ¶ˆæ¯é˜Ÿåˆ—ä¸­è¿˜æœ‰æœªå¤„ç†æˆ–æ­£åœ¨å¤„ç†æ¶ˆæ¯)),å°†ä½¿å¾—å¤–éƒ¨ç±»æ— æ³•è¢«åƒåœ¾å›æ”¶å™¨(GC)å›æ”¶ï¼Œæ—¢é€ æˆå†…å­˜æ³„éœ²ã€‚</p>
</li>
</ul>
<h3 id="å¦‚æœè§‰å¾—æ­¤æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼ŒğŸ‘ğŸ»è¯·ç‚¹ä¸ªèµğŸ‘ğŸ»"><a href="#å¦‚æœè§‰å¾—æ­¤æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼ŒğŸ‘ğŸ»è¯·ç‚¹ä¸ªèµğŸ‘ğŸ»" class="headerlink" title="å¦‚æœè§‰å¾—æ­¤æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼ŒğŸ‘ğŸ»è¯·ç‚¹ä¸ªèµğŸ‘ğŸ»"></a><font color=#9dc2af>å¦‚æœè§‰å¾—æ­¤æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼ŒğŸ‘ğŸ»è¯·ç‚¹ä¸ªèµğŸ‘ğŸ»</font></h3>]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Handler</tag>
      </tags>
  </entry>
  <entry>
    <title>Android-å¦‚ä½•ä½¿ç”¨æ³¨è§£è¿›è¡Œä»£ç æ£€æŸ¥</title>
    <url>/relaxed/Android-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3%E8%BF%9B%E8%A1%8C%E4%BB%A3%E7%A0%81%E6%A3%80%E6%9F%A5/</url>
    <content><![CDATA[<h3 id="Nullness-æ³¨è§£"><a href="#Nullness-æ³¨è§£" class="headerlink" title="Nullness æ³¨è§£"></a>Nullness æ³¨è§£</h3><ul>
<li>ä½¿ç”¨ Nullness æ³¨è§£å¯ä»¥æ£€æŸ¥ç»™å®šå˜é‡ã€å‚æ•°å’Œè¿”å›å€¼æ˜¯å¦å…è®¸ nullå€¼<ul>
<li>@Nullable ï¼šè¡¨ç¤ºå¯ä»¥ä¸º null çš„å˜é‡ã€å‚æ•°æˆ–è¿”å›å€¼ï¼Œ</li>
<li>@NonNull ï¼šè¡¨ç¤ºä¸å¯ä¸º null çš„å˜é‡ã€å‚æ•°æˆ–è¿”å›å€¼ã€‚</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@NonNull</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> View <span class="title function_">onCreateView</span><span class="params">(String name, <span class="meta">@NonNull</span> Context context,<span class="meta">@NonNull</span> AttributeSet attrs)</span> &#123;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="èµ„æºæ³¨è§£"><a href="#èµ„æºæ³¨è§£" class="headerlink" title="èµ„æºæ³¨è§£"></a>èµ„æºæ³¨è§£</h3><ul>
<li>èµ„æºæ³¨è§£çš„ä½¿ç”¨å¯ä½¿å¾—åœ¨æºç é˜¶æ®µè®©ç¼–è¾‘å™¨æ£€æŸ¥ä¹¦å†™çš„ä¸è§„èŒƒï¼Œä¸€å®šç¨‹åº¦ä¸Šä¼˜åŒ–ä»£ç ç»“æ„<ul>
<li>@StringResï¼š      è¡¨ç¤ºæ£€æŸ¥æ˜¯å¦åŒ…å«R.stringå¼•ç”¨</li>
<li>@ColorResï¼š       è¡¨ç¤ºæ£€æŸ¥æ˜¯å¦åŒ…å«R.colorå¼•ç”¨</li>
<li>@ColorIntï¼š       è¡¨ç¤ºæ£€æŸ¥æ˜¯å¦åŒ…å«è¡¨ç¤ºé¢œè‰²çš„æ•´å‹</li>
<li>@DrawableResï¼š    è¡¨ç¤ºæ£€æŸ¥æ˜¯å¦åŒ…å«R.drawableå¼•ç”¨</li>
<li>@DimenResï¼š       è¡¨ç¤ºæ£€æŸ¥æ˜¯å¦åŒ…å«R.dimenå¼•ç”¨</li>
<li>@InterpolatorResï¼šè¡¨ç¤ºæ£€æŸ¥æ˜¯å¦åŒ…å«æ’å€¼å™¨å¼•ç”¨</li>
</ul>
</li>
</ul>
<h3 id="çº¿ç¨‹æ³¨è§£"><a href="#çº¿ç¨‹æ³¨è§£" class="headerlink" title="çº¿ç¨‹æ³¨è§£"></a>çº¿ç¨‹æ³¨è§£</h3><ul>
<li>çº¿ç¨‹æ³¨è§£å¯ä»¥æ£€æŸ¥æŸä¸ªæ–¹æ³•æ˜¯å¦ä»æŸä¸ªç‰¹å®šç±»å‹çš„çº¿ç¨‹ä¸­è°ƒç”¨<ul>
<li>@MainThreadï¼šè¡¨ç¤ºä¸»çº¿ç¨‹</li>
<li>@UiThreadï¼šè¡¨ç¤º UI çº¿ç¨‹</li>
<li>@WorkerThreadï¼šè¡¨ç¤ºå·¥ä½œçº¿ç¨‹</li>
<li>@BinderThreadï¼šè¡¨ç¤ºBinderçº¿ç¨‹</li>
<li>@AnyThreadï¼šè¡¨ç¤ºä»»ä½•ä¸€ä¸ªçº¿ç¨‹</li>
</ul>
</li>
</ul>
<h3 id="å€¼çº¦æŸæ³¨è§£"><a href="#å€¼çº¦æŸæ³¨è§£" class="headerlink" title="å€¼çº¦æŸæ³¨è§£"></a>å€¼çº¦æŸæ³¨è§£</h3><ul>
<li>ä½¿ç”¨å€¼çº¦æŸæ³¨è§£å¯éªŒè¯ä¼ é€’çš„å‚æ•°çš„å€¼çš„åˆæ³•æ€§ï¼Œå¯ä»¥å€Ÿæ­¤æŒ‡å®šå‚æ•°çš„è®¾ç½®èŒƒå›´ï¼Œå¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šå‡å°‘ä»£ç åœ¨ä¸»è§‚ç¨‹åº¦ä¸Šå‡ºç°çš„é”™è¯¯<ul>
<li>@IntRangeï¼šè¡¨ç¤ºå¯ä»¥éªŒè¯æ•´å‹å‚æ•°æ˜¯å¦åœ¨æŒ‡å®šèŒƒå›´å†… </li>
<li>@FloatRangeï¼šè¡¨ç¤ºå¯ä»¥éªŒè¯æµ®ç‚¹å‹å‚æ•°æ˜¯å¦åœ¨æŒ‡å®šèŒƒå›´å†…</li>
<li>@Sizeï¼šè¡¨ç¤ºå¯ä»¥éªŒè¯é›†åˆã€æ•°ç»„ã€å­—ç¬¦ä¸²å‚æ•°æ˜¯å¦åœ¨æŒ‡å®šèŒƒå›´å†…ï¼Œå¯æŒ‡å®šæœ€å¤§å€¼ã€æœ€å°å€¼ä»¥åŠç¡®åˆ‡å€¼</li>
</ul>
</li>
</ul>
<h3 id="æƒé™æ³¨è§£"><a href="#æƒé™æ³¨è§£" class="headerlink" title="æƒé™æ³¨è§£"></a>æƒé™æ³¨è§£</h3><ul>
<li>æƒé™æ³¨è§£ @RequiresPermission å¯ä»¥éªŒè¯æ–¹æ³•è°ƒç”¨æ–¹çš„æƒé™ï¼Œå³å½“ä½¿ç”¨äº†æƒé™æ³¨è§£çš„æ–¹æ³•æ—¶ä¼šæ£€æŸ¥æœ‰æ²¡æœ‰æŒ‡å®šçš„æƒé™ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¼šæç¤ºè¦åœ¨ AndroidManifest.xml æ–‡ä»¶ä¸­ç”³æ˜æƒé™ï¼Œå¦‚æœæ˜¯å±é™©æƒé™è¿˜æœ‰è¿›è¡Œæƒé™åŠ¨æ€ç”³è¯·</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å•ä¸ªæƒé™æ£€æŸ¥</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> message</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequiresPermission(Manifest.permission.WRITE_EXTERNAL_STORAGE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMessage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…¨éƒ¨æƒé™æ£€æŸ¥</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> message</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequiresPermission(allOf = &#123;</span></span><br><span class="line"><span class="meta">        Manifest.permission.WRITE_EXTERNAL_STORAGE,</span></span><br><span class="line"><span class="meta">        Manifest.permission.READ_EXTERNAL_STORAGE&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMesage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æŸä¸ªæƒé™æ£€æŸ¥</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> message</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RequiresPermission(anyOf = &#123;</span></span><br><span class="line"><span class="meta">        Manifest.permission.WRITE_EXTERNAL_STORAGE,</span></span><br><span class="line"><span class="meta">        Manifest.permission.READ_EXTERNAL_STORAGE&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setMesage</span><span class="params">(String message)</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è¿”å›å€¼æ³¨è§£"><a href="#è¿”å›å€¼æ³¨è§£" class="headerlink" title="è¿”å›å€¼æ³¨è§£"></a>è¿”å›å€¼æ³¨è§£</h3><ul>
<li>è¿”å›å€¼æ³¨è§£ @CheckResult ä¼šæ£€æŸ¥æŸä¸ªæ–¹æ³•çš„è¿”å›å€¼æ˜¯å¦è¢«ä½¿ç”¨ï¼Œå¦‚æœæ²¡æœ‰è¢«ä½¿ç”¨ï¼Œåˆ™ä¼šæ ¹æ® suggest é…ç½®å»ºè®®ä½¿ç”¨ç›¸åŒå…¬æ°‘æ²¡æœ‰è¿”å›å€¼çš„å¦ä¸€ä¸ªæ–¹æ³•ï¼Œå¦‚æœè¿”å›å€¼ä½¿ç”¨äº†ï¼Œåˆ™å’ŒæœªåŠ è¯¥æ³¨è§£çš„æ–¹æ³•ä¸€æ ·</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@CheckResult(suggest=&quot;#enforcePermission(String,int,int,String)&quot;)</span></span><br><span class="line"><span class="keyword">public</span>  <span class="type">int</span> <span class="title function_">checkPermission</span><span class="params">(<span class="meta">@NonNull</span> String permission, <span class="type">int</span> pid, <span class="type">int</span> uid)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="CallSuper"><a href="#CallSuper" class="headerlink" title="CallSuper"></a>CallSuper</h3><ul>
<li>ä½¿ç”¨ @CallSuper æ³¨è§£ä¼šéªŒè¯å­ç±»çš„é‡å†™æ–¹æ³•æ˜¯å¦è°ƒç”¨çˆ¶ç±»çš„å®ç°ï¼Œè¿™æ ·çº¦æŸçš„å¥½å¤„æ˜¯å¯ä¿è¯çˆ¶ç±»çš„å®ç°ä¸ä¼šä¿®æ”¹ï¼Œå½“ç„¶ï¼Œå¦‚æœä¸ä½¿ç”¨è¯¥æ³¨è§£ï¼Œå­ç±»é‡å†™çˆ¶ç±»çš„æ–¹æ³•å¯ä»¥ä¸è°ƒç”¨å¼—çˆ¶ç±»çš„é»˜è®¤å®ç°</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * çˆ¶ç±»</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@CallSuper</span>æ³¨è§£çš„ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="comment">//ä½¿ç”¨@CallSuperæ³¨è§£ï¼Œå­ç±»é‡å†™è¯¥æ–¹æ³•æ—¶å¿…é¡»è°ƒç”¨è¯¥æ–¹æ³•</span></span><br><span class="line">    <span class="meta">@CallSuper</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">()</span>&#123;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Typedefæ³¨è§£"><a href="#Typedefæ³¨è§£" class="headerlink" title="Typedefæ³¨è§£"></a>Typedefæ³¨è§£</h3><ul>
<li>ä½¿ç”¨ @IntDef å’Œ @StringDef æ³¨è§£ å¯ä»¥åˆ›å»ºæ•´å‹å’Œå­—ç¬¦ä¸²çš„æšä¸¾æ³¨è§£æ¥éªŒè¯å…¶ä»–ä»£ç ä¸­ä½¿ç”¨çš„æŸäº›æ•´å‹å’Œå­—ç¬¦ä¸²ï¼Œå¯ä»¥ä¿è¯ä»£ç ä¸­çš„æŸäº›å¸¸é‡æ•´å‹æˆ–å¸¸é‡å­—ç¬¦ä¸²æ˜¯æŸäº›å…·ä½“å®šä¹‰çš„å¸¸é‡é›†ï¼Œè¿™ä¸¤ä¸ªæ³¨è§£çš„ä½ç½®åªèƒ½æ˜¯æ³¨è§£</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Typedef æ³¨è§£çš„å®šä¹‰</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ActionType</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ACTION_TYPE_0</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ACTION_TYPE_1</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">ACTION_TYPE_2</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Retention(RetentionPolicy.SOURCE)</span></span><br><span class="line">    <span class="meta">@IntDef(&#123;ACTION_TYPE_0,ACTION_TYPE_1,ACTION_TYPE_2&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="meta">@interface</span> ActionTypeDef&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¯è®¿é—®æ€§æ³¨è§£"><a href="#å¯è®¿é—®æ€§æ³¨è§£" class="headerlink" title="å¯è®¿é—®æ€§æ³¨è§£"></a>å¯è®¿é—®æ€§æ³¨è§£</h3><ul>
<li>å¯è®¿é—®æ€§æ³¨è§£æ˜¯ @VisibleForTesting å’Œ @Keep å¯ä»¥è¡¨ç¤ºæ–¹æ³•ã€å­—æ®µã€ç±»çš„å¯è®¿é—®æ€§<ul>
<li>@VisibleForTestingï¼šè¡¨ç¤ºæ³¨è§£çš„æŸä¸ªä»£ç å—çš„å¯è§æ€§é«˜äºèƒ½å¤Ÿæµ‹è¯•æ—¶éœ€è¦çš„æ°´å¹³</li>
<li>@Keepï¼šè¡¨ç¤ºè¢«æ³¨è§£çš„ä»£ç å—å°†ä¸ä¼šè¢«æ··æ·†ã€‚</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>æ³¨è§£</tag>
      </tags>
  </entry>
  <entry>
    <title>Handler-æ¶ˆæ¯é€šè®¯æœºåˆ¶è¯¦è§£</title>
    <url>/relaxed/Handler-%E6%B6%88%E6%81%AF%E9%80%9A%E8%AE%AF%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><ul>
<li>Androidå¼€å‘ä¸­ï¼ŒHandleråª’ä»‹æœºåˆ¶ååˆ†å¸¸ç”¨ï¼Œä»Šå¤©æˆ‘ä»¬æ¥è¯¦ç»†èŠä¸€èŠHandleré€šè®¯æœºåˆ¶æ˜¯å¦‚ä½•å®ç°çš„ã€‚</li>
</ul>
<h1 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h1><p><a href="https://s1.ax1x.com/2022/05/05/Omb4mt.png"><img src="https://s1.ax1x.com/2022/05/05/Omb4mt.png" alt="Omb4mt.png"></a></p>
<h1 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h1><p>åœ¨å¤šçº¿ç¨‹çš„åº”ç”¨åœºæ™¯ä¸­ï¼Œå°†å·¥ä½œçº¿ç¨‹ä¸­éœ€æ›´æ–°UIçš„æ“ä½œä¿¡æ¯ ä¼ é€’åˆ° UIä¸»çº¿ç¨‹ï¼Œä»è€Œå®ç°å·¥ä½œçº¿ç¨‹å¯¹UIçº¿ç¨‹çš„æ›´æ–°ï¼Œæœ€ç»ˆå®ç°å¼‚æ­¥æ¶ˆæ¯çš„å¤„ç†ã€‚</p>
<h1 id="æ¦‚å¿µæè¿°"><a href="#æ¦‚å¿µæè¿°" class="headerlink" title="æ¦‚å¿µæè¿°"></a>æ¦‚å¿µæè¿°</h1><p>Handlerã€Messageã€MessageQueueã€Looperç›¸å…³æ¦‚å¿µå¦‚ä¸‹å›¾ã€‚</p>
<!--MarkDown ä¸æ”¯æŒå•å…ƒæ ¼åˆå¹¶ï¼Œå³ä½¿ç”¨Html -->
<table>
<!--this is title-->
    <tr align = "center" bgcolor = "#91bdb6">
        <td>æ¦‚å¿µ</td>
        <td>å®šä¹‰</td>
        <td>ä½œç”¨</td>
        <!-- <td>å¤‡æ³¨</td> -->
    </tr>
    <!--this is Main-->
    <tr align="center">
        <td>ä¸»çº¿ç¨‹<br/><font color = "#91bdb6">( UIçº¿ç¨‹ã€Main Thread )</font></td>
        <td>ç³»ç»Ÿé¦–æ¬¡å¯åŠ¨ï¼Œä¼šåˆ›å»ºä¸»çº¿ç¨‹</td>
        <td>å¤„ç†UIç›¸å…³æ“ä½œ<br/><font color = "#91bdb6">( å¦‚ï¼šæ›´æ–°UI )</font></td>
        <!-- <td rowspan="2">ä¸»çº¿ç¨‹ä¸å­çº¿ç¨‹<br/>é€šè®¯åª’ä»‹Handler</td> -->
    </tr>
      <!--this is Thread-->
    <tr align="center">
        <td>å­çº¿ç¨‹<br/><font color = "#91bdb6">ï¼ˆ å·¥ä½œçº¿ç¨‹ ï¼‰</font></td>
        <td>äººä¸ºå¼€å¯çš„çº¿ç¨‹</td>
        <td>æ‰§è¡Œè€—æ—¶ä»»åŠ¡<br/><font color = "#91bdb6">( å¦‚ ç½‘ç»œè¯·æ±‚ã€æ•°æ®åŠ è½½ç­‰ )</font></td>
    </tr>
      <!--this is Message-->
    <tr align="center">
      <td>æ¶ˆæ¯<br/><font color = "#91bdb6">ï¼ˆ Message ï¼‰</font></td>
      <td>çº¿ç¨‹é—´é€šè®¯æ•°æ®å•å…ƒ<br/><font color = "#91bdb6">ï¼ˆhandleræ¥æ”¶&å¤„ç†æ¶ˆæ¯å¯¹è±¡ï¼‰</font></td>
      <td>å­˜å‚¨ä¸šåŠ¡æ“ä½œä¿¡æ¯<br/><font color = "#91bdb6">ï¼ˆ Message ï¼‰</font></td>
    </tr>
      <!--this is Message Queue-->
    <tr align="center">
        <td>æ¶ˆæ¯é˜Ÿåˆ—<br/><font color = "#91bdb6">ï¼ˆ Message Queue ï¼‰</font></td>
        <td>æ•°æ®ç»“æ„<br/><font color = "#91bdb6">ï¼ˆ ä»¥æ—¶é—´é¡ºåºæ’åˆ— ï¼‰</font></td>
        <td>å­˜å‚¨Handlerå‘é€çš„æ¶ˆæ¯<br/><font color = "#91bdb6">ï¼ˆ Message ï¼‰</font></td>
    </tr>
      <!--this is Handler-->
    <tr align="center">
        <td>å¤„ç†ç€<br/><font color = "#91bdb6">ï¼ˆ Handler ï¼‰</font></td>
        <td>ä¸»çº¿ç¨‹ä¸å­çº¿ç¨‹é€šè®¯çš„åª’ä»‹<br/>çº¿ç¨‹æ¶ˆæ¯çš„å¤„ç†è€…</td>
        <td>å°†æ¶ˆæ¯( Message ï¼‰æ·»åŠ åˆ°<br/>æ¶ˆæ¯é˜Ÿåˆ—( Message Queue )ä¸­<br/> å¤„ç†å¾ªç¯å™¨ï¼ˆ Looper ï¼‰åˆ†æ´¾çš„æ¶ˆæ¯</td>
    </tr>
    <tr align="center">
        <td>å¾ªç¯å™¨<br/><font color = "#91bdb6">ï¼ˆ Looper ï¼‰</font></td>
        <td>æ¶ˆæ¯é˜Ÿåˆ—( Message Queue )<br/>ä¸å¤„ç†è€… ï¼ˆ Handler ï¼‰<br/>é€šè®¯åª’ä»‹</td>
        <td>æ¶ˆæ¯å¾ªç¯ å³ï¼š<br/><font color = "#91bdb6"> æ¶ˆæ¯è·å–ï¼šå¾ªç¯å–å‡ºæ¶ˆæ¯é˜Ÿåˆ—<br/>ï¼ˆ Message Queue ï¼‰ä¸­çš„<br/>æ¶ˆæ¯ï¼ˆ Message ï¼‰<br/> æ¶ˆæ¯åˆ†å‘ï¼šå°†å–å‡ºæ¥çš„æ¶ˆæ¯<br/>ï¼ˆ Message ï¼‰å‘é€ç»™å¯¹åº”çš„<br/>å¤„ç†è€…ï¼ˆ Handler ï¼‰</font></td>
    </tr>
</table>

<h1 id="æœºåˆ¶è¯´æ˜"><a href="#æœºåˆ¶è¯´æ˜" class="headerlink" title="æœºåˆ¶è¯´æ˜"></a>æœºåˆ¶è¯´æ˜</h1><p>Handleræ¶ˆæ¯ä¼ é€’æœºåˆ¶:å¤šä¸ªçº¿ç¨‹å¹¶å‘æ›´æ–°UIæ—¶ï¼Œä¿è¯çº¿ç¨‹å®‰å…¨<br><a href="https://s1.ax1x.com/2022/05/06/OmxK4P.png"><img src="https://s1.ax1x.com/2022/05/06/OmxK4P.png" alt="ç¤ºä¾‹å›¾.png"></a><br>æ³¨ï¼š<a href="https://juejin.cn/post/6844903890224152584">å›¾è§£Javaçº¿ç¨‹å®‰å…¨</a></p>
<h1 id="åŸç†è§£æ"><a href="#åŸç†è§£æ" class="headerlink" title="åŸç†è§£æ"></a>åŸç†è§£æ</h1><h3 id="ç›¸å…³æ¦‚å¿µ"><a href="#ç›¸å…³æ¦‚å¿µ" class="headerlink" title="ç›¸å…³æ¦‚å¿µ"></a>ç›¸å…³æ¦‚å¿µ</h3><ul>
<li><p>å¼‚æ­¥é€šä¿¡( ä¸»çº¿ç¨‹ä¸­åˆ›å»º )</p>
<blockquote>
<blockquote>
<p>å¤„ç†è€…ï¼ˆ Handler ï¼‰å¯¹è±¡</p>
<blockquote>
<p>æ³¨ï¼šHandlerä¼šè‡ªå®šç»‘å®šä¸»çº¿ç¨‹ä¸­çš„Looper&amp;MessageQueue</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>å¤„ç†å™¨ï¼ˆ Looper ï¼‰å¯¹è±¡</p>
<blockquote>
<p>æ³¨ï¼šLooper &amp; MessageQueueéƒ½æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆ Message Queue ï¼‰å¯¹è±¡</p>
<blockquote>
<p>æ³¨ï¼š åˆ›å»ºMessageQueueåï¼ŒLooperä¼šè‡ªåŠ¨è¿›å…¥å¾ªç¯çŠ¶æ€ï¼Œæœ‰æ¶ˆæ¯åˆ™å¾ªç¯å–ï¼Œæ²¡æœ‰ï¼Œåˆ™é˜»å¡çŠ¶æ€ï¼Œå‘ç°æ¶ˆæ¯åä¼šè¢«å”¤é†’ç»§ç»­å¾ªç¯è¯»å–ã€‚</p>
</blockquote>
</blockquote>
</blockquote>
</li>
<li><p>æ¶ˆæ¯å…¥é˜Ÿåˆ—</p>
<blockquote>
<p>å·¥ä½œçº¿ç¨‹ä¸­é€šè¿‡Handlerçš„sendMessage()æ–¹æ³•å‘é€æ¶ˆæ¯ï¼ˆ Message ï¼‰åˆ°æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆ MessageQueue ï¼‰ä¸­ï¼Œè¿™æ˜¯æ¶ˆæ¯å®Œæˆå…¥é˜Ÿåˆ—æ“ä½œã€‚</p>
<blockquote>
<p>æ³¨ï¼šæ­¤æ¶ˆæ¯å†…å®¹å°±æ˜¯å·¥ä½œçº¿ç¨‹å¯¹UIä¸»çº¿ç¨‹çš„æ“ä½œ</p>
</blockquote>
</blockquote>
</li>
<li><p>æ¶ˆæ¯å¾ªç¯</p>
<blockquote>
<p>ç¬¬ä¸€æ­¥ï¼šæ¶ˆæ¯å‡ºé˜Ÿåˆ—ï¼šLooperå¾ªç¯å–å‡ºæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆ MessageQueue ï¼‰ä¸­çš„æ¶ˆæ¯ï¼ˆ Message ï¼‰äº¤ç»™ç¬¬äºŒæ­¥æ¶ˆæ¯åˆ†å‘ã€‚<br>ç¬¬äºŒæ­¥ï¼šæ¶ˆæ¯åˆ†å‘ï¼šLooperå°†å–å‡ºæ¥çš„æ¶ˆæ¯ï¼ˆ Message ï¼‰å‘é€ç»™åˆ›å»ºæ¶ˆæ¯çš„å¤„ç†è€…ï¼ˆ Handler ï¼‰</p>
<blockquote>
<p>æ³¨ï¼šå¾ªç¯å™¨( Looper )å¾ªç¯å–æ¶ˆæ¯æ—¶ï¼Œè‹¥å‘ç°æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆ MessageQueue ï¼‰ä¸­ä¸ºç©ºï¼Œåˆ™ä¼šçº¿ç¨‹é˜»å¡ï¼Œå¾…åˆæ¶ˆæ¯æ—¶å†æ¬¡è¢«å”¤é†’ç»§ç»­å¾ªç¯è¯»å–ã€‚</p>
</blockquote>
</blockquote>
</li>
<li><p>æ¶ˆæ¯å¤„ç†</p>
<blockquote>
<p>å¤„ç†è€…( Handler ) åœ¨æ¥æ”¶å¤„ç†å™¨ï¼ˆ Looper ï¼‰å‘é€è¿‡æ¥çš„æ¶ˆæ¯ï¼ˆ Message ï¼‰ä¼šè¿›è¡ŒUIæ“ä½œã€‚</p>
</blockquote>
</li>
</ul>
<p><a href="https://s1.ax1x.com/2022/05/06/OuFqzR.png"><img src="https://s1.ax1x.com/2022/05/06/OuFqzR.png" alt="ç¤ºæ„å›¾.png"></a></p>
<p>æ³¨ï¼š<a href="https://www.zhihu.com/question/34652589">Androidä¸­ä¸ºä»€ä¹ˆä¸»çº¿ç¨‹ä¸ä¼šå› ä¸ºLooper.loop()é‡Œçš„æ­»å¾ªç¯å¡æ­»ï¼Ÿ</a></p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>Androidå¼€å‘ä¸­ï¼ŒUIæ“ä½œåœ¨ä¸»çº¿ç¨‹ä¸­è¿›è¡Œï¼Œä½†æ˜¯ä¸»çº¿ç¨‹åˆä¸èƒ½è¿›è¡Œè€—æ—¶æ“ä½œï¼Œå¦åˆ™ä¼šé˜»å¡çº¿ç¨‹ï¼Œäº§ç”Ÿæˆ‘ä»¬å¸¸è§çš„ANRå¼‚å¸¸ï¼Œæ‰€ä»¥å¸¸å¸¸æŠŠè€—æ—¶æ“ä½œæ”¾åˆ°å…¶å®ƒå­çº¿ç¨‹è¿›è¡Œã€‚å¦‚æœåœ¨å­çº¿ç¨‹ä¸­éœ€è¦æ›´æ–°UIï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ Handlerå‘é€æ¶ˆæ¯( message ï¼‰ï¼Œä¸»çº¿ç¨‹æ¥æ”¶æ¶ˆæ¯å¹¶ä¸”è¿›è¡Œç›¸åº”çš„å¤„ç†ã€‚ä»¥ä¸Šå°±æ˜¯Handleré€šè®¯æ¶ˆæ¯ä¼ é€’æœºåˆ¶çš„è¯¦è§£ã€‚</p>
<h3 id="å¦‚æœè§‰å¾—æ­¤æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼ŒğŸ‘ğŸ»è¯·ç‚¹ä¸ªèµğŸ‘ğŸ»"><a href="#å¦‚æœè§‰å¾—æ­¤æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼ŒğŸ‘ğŸ»è¯·ç‚¹ä¸ªèµğŸ‘ğŸ»" class="headerlink" title="å¦‚æœè§‰å¾—æ­¤æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼ŒğŸ‘ğŸ»è¯·ç‚¹ä¸ªèµğŸ‘ğŸ»"></a><font color=#9dc2af>å¦‚æœè§‰å¾—æ­¤æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼ŒğŸ‘ğŸ»è¯·ç‚¹ä¸ªèµğŸ‘ğŸ»</font></h3>]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Handler</tag>
      </tags>
  </entry>
  <entry>
    <title>Glide-ç¼“å­˜é‚£äº›äº‹å„¿</title>
    <url>/relaxed/glide-%E7%BC%93%E5%AD%98%E9%82%A3%E4%BA%9B%E4%BA%8B%E5%84%BF/</url>
    <content><![CDATA[<h1 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h1><p> &ensp;åœ¨æˆ‘ä»¬å¼€å‘çš„æ—¶å€™å¯¹å›¾ç‰‡åŠ è½½æ˜¯å¿…é¡»ä½¿ç”¨çš„ è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å°±èŠèŠGlideç¼“å­˜ã€‚</p>
<h2 id="Glide-ç¼“å­˜åˆ†å‡ ç§"><a href="#Glide-ç¼“å­˜åˆ†å‡ ç§" class="headerlink" title="Glide ç¼“å­˜åˆ†å‡ ç§"></a>Glide ç¼“å­˜åˆ†å‡ ç§</h2><p>ç­”ï¼šç¼“å­˜åˆ†ä¸ºä¸¤ç§ï¼šå†…å­˜ç¼“å­˜ã€ç£ç›˜ç¼“å­˜</p>
<p>å†…å­˜ç¼“å­˜ï¼š<br>å†…å­˜ç¼“å­˜åˆåˆ†ä¸ºä¸¤ç§ï¼šä¸€ç§æ˜¯ï¼šå¼±å¼•ç”¨ç¼“å­˜ã€ä¸€ç§æ˜¯ï¼š Lrucacheç¼“å­˜ã€‚<br>å¾€ä¸‹çœ‹Glideå†…å­˜ç¼“å­˜æ˜¯å¦‚ä½•å®ç°çš„ï¼Œæºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;R&gt; LoadStatus <span class="title function_">load</span><span class="params">(</span></span><br><span class="line"><span class="params">      GlideContext glideContext,</span></span><br><span class="line"><span class="params">      Object model,</span></span><br><span class="line"><span class="params">      Key signature,</span></span><br><span class="line"><span class="params">      <span class="type">int</span> width,</span></span><br><span class="line"><span class="params">      <span class="type">int</span> height,</span></span><br><span class="line"><span class="params">      Class&lt;?&gt; resourceClass,</span></span><br><span class="line"><span class="params">      Class&lt;R&gt; transcodeClass,</span></span><br><span class="line"><span class="params">      Priority priority,</span></span><br><span class="line"><span class="params">      DiskCacheStrategy diskCacheStrategy,</span></span><br><span class="line"><span class="params">      Map&lt;Class&lt;?&gt;, Transformation&lt;?&gt;&gt; transformations,</span></span><br><span class="line"><span class="params">      <span class="type">boolean</span> isTransformationRequired,</span></span><br><span class="line"><span class="params">      <span class="type">boolean</span> isScaleOnlyOrNoTransform,</span></span><br><span class="line"><span class="params">      Options options,</span></span><br><span class="line"><span class="params">      <span class="type">boolean</span> isMemoryCacheable,</span></span><br><span class="line"><span class="params">      <span class="type">boolean</span> useUnlimitedSourceExecutorPool,</span></span><br><span class="line"><span class="params">      <span class="type">boolean</span> useAnimationPool,</span></span><br><span class="line"><span class="params">      <span class="type">boolean</span> onlyRetrieveFromCache,</span></span><br><span class="line"><span class="params">      ResourceCallback cb,</span></span><br><span class="line"><span class="params">      Executor callbackExecutor)</span> &#123;</span><br><span class="line">    <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> VERBOSE_IS_LOGGABLE ? LogTime.getLogTime() : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”Ÿæˆkey</span></span><br><span class="line">    <span class="type">EngineKey</span> <span class="variable">key</span> <span class="operator">=</span></span><br><span class="line">        keyFactory.buildKey(</span><br><span class="line">            model,</span><br><span class="line">            signature,</span><br><span class="line">            width,</span><br><span class="line">            height,</span><br><span class="line">            transformations,</span><br><span class="line">            resourceClass,</span><br><span class="line">            transcodeClass,</span><br><span class="line">            options);</span><br><span class="line"></span><br><span class="line">    EngineResource&lt;?&gt; memoryResource;</span><br><span class="line">    <span class="keyword">synchronized</span> (<span class="built_in">this</span>) &#123;</span><br><span class="line">    <span class="comment">//è¿›åˆ°loadFromMemoryæ–¹æ³•é‡Œé¢çœ‹çœ‹åšäº†ä»€ä¹ˆ</span></span><br><span class="line">      memoryResource = loadFromMemory(key, isMemoryCacheable, startTime);</span><br><span class="line"></span><br><span class="line">     ...</span><br><span class="line"></span><br><span class="line"> <span class="meta">@Nullable</span></span><br><span class="line">  <span class="keyword">private</span> EngineResource&lt;?&gt; loadFromMemory(</span><br><span class="line">      EngineKey key, <span class="type">boolean</span> isMemoryCacheable, <span class="type">long</span> startTime) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isMemoryCacheable) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¼±å¼•ç”¨</span></span><br><span class="line">    EngineResource&lt;?&gt; active = loadFromActiveResources(key);</span><br><span class="line">    <span class="keyword">if</span> (active != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (VERBOSE_IS_LOGGABLE) &#123;</span><br><span class="line">        logWithTimeAndKey(<span class="string">&quot;Loaded resource from active resources&quot;</span>, startTime, key);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> active;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">// LruCaChe</span></span><br><span class="line">    EngineResource&lt;?&gt; cached = loadFromCache(key);</span><br><span class="line">    <span class="keyword">if</span> (cached != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (VERBOSE_IS_LOGGABLE) &#123;</span><br><span class="line">        logWithTimeAndKey(<span class="string">&quot;Loaded resource from cache&quot;</span>, startTime, key);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> cached;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// å¦‚æœè¿”å›null ï¼Œä»ç½‘ç»œæˆ–å…¶å®ƒåœ°æ–¹è·å–</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒEngineç±»ä¸­loadæ–¹æ³•å›¾ç‰‡åŠ è½½ç­–ç•¥ï¼Œå…¶ä¸­ç”Ÿæˆkeyçš„å‚æ•°ä¸­åŒ…å«width ã€height<br> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="type">EngineKey</span> <span class="variable">key</span> <span class="operator">=</span> keyFactory.buildKey(model, signature, width, height, transformations,</span><br><span class="line">      resourceClass, transcodeClass, options);</span><br></pre></td></tr></table></figure></p>
<ul>
<li> width  &amp; height å°±æ˜¯ImageViewçš„å°ºå¯¸ï¼Œç”Ÿæˆkeyæ—¶ä¸ºä»€ä¹ˆä¼šä¼ å…¥ImageViewçš„å°ºå¯¸å‘¢ï¼Ÿ</li>
<li>æ³¨ï¼šGlide é€šè¿‡keyè¯»å–ç¼“å­˜å›¾ç‰‡æ—¶ï¼Œä¼šæ ¡éªŒå½“å‰çš„å›¾ç‰‡å°ºå¯¸æ˜¯å¦ä¸imageViewçš„å°ºå¯¸ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰ç›´æ¥å–å‡ºæ¥æ˜¾ç¤ºï¼Œå¦‚æœä¸ç›¸ç­‰ï¼Œä¼šé‡æ–°ç”Ÿæˆæ–°çš„ç¼“å­˜æ•°æ®ã€‚</li>
</ul>
<h3 id="å¼±å¼•ç”¨ç¼“å­˜ï¼š"><a href="#å¼±å¼•ç”¨ç¼“å­˜ï¼š" class="headerlink" title="å¼±å¼•ç”¨ç¼“å­˜ï¼š"></a>å¼±å¼•ç”¨ç¼“å­˜ï¼š</h3><p> &ensp;æ¥ç€å¾€ä¸‹çœ‹ï¼Œé¦–å…ˆä»å¼±å¼•ç”¨ä¸­è·å–æ•°æ®ï¼š<br>  <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  EngineResource&lt;?&gt; active = loadFromActiveResources(key, isMemoryCacheable);</span><br><span class="line">  //æ–¹æ³•å†…éƒ¨å®ç°</span><br><span class="line"> @Nullable</span><br><span class="line">  private EngineResource&lt;?&gt; loadFromActiveResources(Key key) &#123;</span><br><span class="line">    EngineResource&lt;?&gt; active = activeResources.get(key);</span><br><span class="line">    if (active != null) &#123;</span><br><span class="line">      active.acquire();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return active;</span><br><span class="line">  &#125;</span><br><span class="line">//æ–¹æ³• acquire</span><br><span class="line">synchronized void acquire() &#123;</span><br><span class="line">    if (isRecycled) &#123;</span><br><span class="line">      throw new IllegalStateException(&quot;Cannot acquire a recycled resource&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    ++acquired;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<ul>
<li>æ³¨ï¼šå¦‚æœå¼±å¼•ç”¨ä¸­è·å–åˆ°æ•°æ®ï¼Œè®¡æ•°å™¨acquired+1ï¼Œå¦‚æœè·å–ä¸åˆ°activeå¯¹è±¡åœ¨åˆé€‚çš„æ—¶æœºè¢«å›æ”¶ï¼Œèµ°LruCaCheç¼“å­˜ï¼Œæ¥ç€å¾€ä¸‹çœ‹ï¼š</li>
</ul>
<h3 id="LruCaCheç¼“å­˜ï¼š"><a href="#LruCaCheç¼“å­˜ï¼š" class="headerlink" title="LruCaCheç¼“å­˜ï¼š"></a>LruCaCheç¼“å­˜ï¼š</h3><p>å¼±å¼•ç”¨ä¸­æœªè·å–åˆ°æ•°æ®ï¼Œåˆ™é€šè¿‡LruCaCheè·å–ï¼Œæºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> EngineResource&lt;?&gt; loadFromCache(Key key) &#123;</span><br><span class="line">    EngineResource&lt;?&gt; cached = getEngineResourceFromCache(key);</span><br><span class="line">    <span class="keyword">if</span> (cached != <span class="literal">null</span>) &#123;</span><br><span class="line">      cached.acquire();</span><br><span class="line">      activeResources.activate(key, cached);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cached;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>æ³¨ï¼šå¦‚æœcachedå¯¹è±¡ä¸ä¸ºç©ºï¼Œåˆ™è°ƒç”¨activeResources.activateæ–¹æ³•å°†å…¶åŠ å…¥å¼±å¼•ç”¨ç¼“å­˜ä¸­ï¼Œä¸”è®¡æ•°å™¨acquired+1</li>
</ul>
<p>è¿›å…¥getEngineResourceFromCacheæ–¹æ³•çœ‹ä¸‹å…·ä½“å®ç°ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> EngineResource&lt;?&gt; getEngineResourceFromCache(Key key) &#123;</span><br><span class="line">  Resource&lt;?&gt; cached = cache.remove(key);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">final</span> EngineResource&lt;?&gt; result;</span><br><span class="line">  <span class="keyword">if</span> (cached == <span class="literal">null</span>) &#123;</span><br><span class="line">    result = <span class="literal">null</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (cached <span class="keyword">instanceof</span> EngineResource) &#123;</span><br><span class="line">    <span class="comment">// Save an object allocation if we&#x27;ve cached an EngineResource (the typical case).</span></span><br><span class="line">    result = (EngineResource&lt;?&gt;) cached;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    result =</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">EngineResource</span>&lt;&gt;(</span><br><span class="line">            cached, <span class="comment">/*isMemoryCacheable=*/</span> <span class="literal">true</span>, <span class="comment">/*isRecyclable=*/</span> <span class="literal">true</span>, key, <span class="comment">/*listener=*/</span> <span class="built_in">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼šä¹‹æ‰€ä»¥é‡‡ç”¨å†…å­˜ç¼“å­˜æ˜¯ä¸ºé˜²æ­¢åº”ç”¨é‡å¤å°†å›¾ç‰‡è¯»å…¥åˆ°å†…å­˜ï¼Œé€ æˆå†…å­˜èµ„æºæµªè´¹ã€‚</p>
<ul>
<li>æ³¨ï¼šä»ä¸Šé¢æºç ä¸­æˆ‘ä»¬çœ‹åˆ°ï¼Œè¯»å†…å­˜ç¼“å­˜çš„æµç¨‹ä¸ºï¼šå…ˆä»å¼±å¼•ç”¨ä¸­å–æ•°æ®ï¼Œå¦‚æœå–åˆ°ï¼Œè®¡æ•°å™¨acquired+1è¿”å›ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œåˆ™ä»LruCaCheä¸­å–ï¼Œå¦‚æœå–åˆ°ï¼Œè®¡æ•°å™¨acquired+1è¿”å›ã€‚å¦‚æœLruCaCheä¸­ä¸å­˜keyå¯¹åº”åœ¨æ•°æ®ï¼Œåˆ™ä¼šèµ°ç£ç›˜ç¼“å­˜ï¼Œå¾€ä¸‹çœ‹ï¼š</li>
</ul>
<h3 id="ç£ç›˜ç¼“å­˜ï¼š"><a href="#ç£ç›˜ç¼“å­˜ï¼š" class="headerlink" title="ç£ç›˜ç¼“å­˜ï¼š"></a>ç£ç›˜ç¼“å­˜ï¼š</h3><p>å…ˆäº†è§£ä»¥ä¸‹ç£ç›˜ç¼“å­˜çš„ç­–ç•¥æœ‰å“ªäº›?</p>
<ul>
<li>ALL:ç¼“å­˜åŸå›¾(SOURCE)å’Œå¤„ç†å›¾(RESULT)</li>
<li>NONE:ä»€ä¹ˆéƒ½ä¸ç¼“å­˜</li>
<li>SOURCE:åªç¼“å­˜åŸå›¾(SOURCE)</li>
<li>RESULT:åªç¼“å­˜å¤„ç†å›¾(RESULT) â€”é»˜è®¤å€¼</li>
</ul>
<p>ä¸Šé¢è®²çš„æ˜¯å†…å­˜è¯»å–æ•°æ®ï¼Œå¦‚æœå†…å­˜æ²¡æœ‰å–åˆ°ï¼Œåˆ™Glideä¼šä»ç£ç›˜ç¼“å­˜å–æ•°æ®ï¼Œé€šè¿‡EngineJobå¼€å¯çº¿ç¨‹æ± å»åŠ è½½å›¾ç‰‡ã€‚è¿™é‡Œæœ‰2ä¸ªå…³é”®ç±»ï¼šDecodeJob å’ŒEngineJobã€‚<br>ä¸€ä¸ªå›¾ç‰‡çš„åŠ è½½åœ¨ DecodeJob è¿™ä¸ªç±»ä¸­ï¼Œè¿™ä¸ªä»»åŠ¡ç”± EngineJob è¿™ä¸ªçº¿ç¨‹æ± å»æ‰§è¡Œçš„ã€‚å»åˆ° run æ–¹æ³•ï¼Œæºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">runWrapped</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (runReason) &#123;</span><br><span class="line">      <span class="keyword">case</span> INITIALIZE:</span><br><span class="line">        stage = getNextStage(Stage.INITIALIZE);</span><br><span class="line">        currentGenerator = getNextGenerator();</span><br><span class="line">        runGenerators();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> SWITCH_TO_SOURCE_SERVICE:</span><br><span class="line">        runGenerators();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> DECODE_DATA:</span><br><span class="line">        decodeFromRetrievedData();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;Unrecognized run reason: &quot;</span> + runReason);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>EngineJob å†…éƒ¨ç»´æŠ¤äº†çº¿ç¨‹æ± ï¼Œç”¨æ¥ç®¡ç†èµ„æºåŠ è½½ï¼Œå½“èµ„æºåŠ è½½å®Œæ¯•çš„æ—¶å€™é€šçŸ¥å›è°ƒï¼›<br>DecodeJobæ˜¯çº¿ç¨‹æ± ä¸­çš„ä¸€ä¸ªä»»åŠ¡ã€‚<br>&ensp;ç£ç›˜ç¼“å­˜æ˜¯é€šè¿‡DiskLruCacheæ¥ç®¡ç†çš„,æ ¹æ®ä¸åŒçš„ç¼“å­˜ç­–ç•¥ï¼Œä¼šæœ‰2ç§ç±»å‹çš„å›¾ç‰‡ï¼š</p>
<ul>
<li>DATAï¼šåŸå§‹å›¾ç‰‡</li>
<li> RESOURCEï¼šè½¬æ¢åçš„å›¾ç‰‡<br>ç£ç›˜ç¼“å­˜ä¾æ¬¡é€šè¿‡ResourcesCacheGeneratorï¼ˆè½¬æ¢è¿‡çš„ç¼“å­˜æ•°æ®ï¼‰ã€SourceGeneratorï¼ˆæœªç»è½¬æ¢çš„åŸå§‹çš„ç¼“å­˜æ•°æ®ï¼‰ã€DataCacheGeneratorï¼ˆç½‘ç»œè·å–å›¾ç‰‡æ•°æ®åæ ¹æ®ç¼“å­˜ç­–ç•¥çš„ä¸åŒå»ç¼“å­˜ä¸åŒçš„å›¾ç‰‡åˆ°ç£ç›˜ä¸Šï¼‰æ¥è·å–ç¼“å­˜æ•°æ®ã€‚<br>æ€»ç»“ï¼šé˜²æ­¢åº”ç”¨é‡å¤çš„ä»ç½‘ç»œæˆ–è€…å…¶ä»–åœ°æ–¹ä¸‹è½½å’Œè¯»å–æ•°æ®</li>
</ul>
<p>å…³äºLruCacheæºç è¯·çœ‹ï¼š<a href="/relaxed/LinkedHashMap-%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/" title="LinkedHashMapåŸç†åˆ†æ">LinkedHashMapåŸç†åˆ†æ</a><br>å…³äºLinedHashMapåŸç†è¯·çœ‹ï¼š <a href="/relaxed/LruCache-%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/" title="LruCacheåŸç†åˆ†æ">LruCacheåŸç†åˆ†æ</a></p>
<h2 id="Glideè¯»å–å›¾ç‰‡ï¼Œè·å–é¡ºåº"><a href="#Glideè¯»å–å›¾ç‰‡ï¼Œè·å–é¡ºåº" class="headerlink" title="Glideè¯»å–å›¾ç‰‡ï¼Œè·å–é¡ºåº"></a>Glideè¯»å–å›¾ç‰‡ï¼Œè·å–é¡ºåº</h2><p>ç­”ï¼š å¼±å¼•ç”¨â€“&gt; LruCacheç®—æ³•â€“&gt; ç£ç›˜ç¼“å­˜(DiskLruCache)</p>
<blockquote>
<p>æˆ‘ä»¬APPä¸­åŠ è½½æŸå¼ å›¾ç‰‡æ—¶ï¼Œå…ˆå»å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰ä¸­å¯»æ‰¾ï¼Œå¦‚æœå¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰ä¸­æœ‰ï¼Œåˆ™ä»WeakReferenceä¸­å–å‡ºå›¾ç‰‡ä½¿ç”¨ï¼Œå¦‚æœWeakReferenceä¸­æ²¡æœ‰å›¾ç‰‡åˆ™å»LruCacheä¸­å¯»æ‰¾å›¾ç‰‡ï¼Œå¦‚æœLruCacheä¸­æœ‰ï¼Œåˆ™å–å‡ºæ¥ä½¿ç”¨ï¼Œå¹¶å°†è¯¥å›¾ç‰‡æ”¾å…¥WeakReferenceä¸­ï¼Œå¦‚æœLruCacheä¸­æ²¡æœ‰ï¼Œåˆ™ä»ç£ç›˜ç¼“å­˜/ç½‘ç»œä¸­åŠ è½½å›¾ç‰‡ã€‚</p>
</blockquote>
<h2 id="Glideç¼“å­˜å›¾ç‰‡ï¼Œå†™å…¥é¡ºåº"><a href="#Glideç¼“å­˜å›¾ç‰‡ï¼Œå†™å…¥é¡ºåº" class="headerlink" title="Glideç¼“å­˜å›¾ç‰‡ï¼Œå†™å…¥é¡ºåº"></a>Glideç¼“å­˜å›¾ç‰‡ï¼Œå†™å…¥é¡ºåº</h2><p>ç­”ï¼šå¼±å¼•ç”¨ â€“&gt; LruCacheç®—æ³• â€“&gt; ç£ç›˜ç¼“å­˜ä¸­(DiskLruCache)</p>
<blockquote>
<p>å½“å›¾ç‰‡ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œä¼šå…ˆä»ç½‘ç»œä¸‹è½½ï¼Œç„¶åå°†å›¾ç‰‡å­˜å…¥å¼±å¼•ç”¨ä¸­ï¼ŒGlideä¼šé‡‡ç”¨ä¸€ä¸ªacquiredå˜é‡ç”¨æ¥è®°å½•å›¾ç‰‡è¢«å¼•ç”¨çš„æ¬¡æ•°<br>å½“acquiredå˜é‡å¤§äº0çš„æ—¶å€™ï¼Œè¯´æ˜å›¾ç‰‡æ­£åœ¨ä½¿ç”¨ä¸­ï¼Œä¹Ÿå°±æ˜¯å°†å›¾ç‰‡æ”¾åˆ°å¼±å¼•ç”¨ç¼“å­˜å½“ä¸­ã€‚<br>å¦‚æœacquiredå˜é‡ç­‰äº0äº†ï¼Œè¯´æ˜å›¾ç‰‡å·²ç»ä¸å†è¢«ä½¿ç”¨äº†ï¼Œé‚£ä¹ˆæ­¤æ—¶ä¼šè°ƒç”¨æ–¹æ³•æ¥é‡Šæ”¾èµ„æºï¼Œé¦–å…ˆä¼šå°†ç¼“å­˜å›¾ç‰‡ä»å¼±å¼•ç”¨ä¸­ç§»é™¤ï¼Œç„¶åå†å°†å®ƒputåˆ°LruResourceCacheå½“ä¸­ã€‚<br>è¿™æ ·ä¹Ÿå°±å®ç°äº†æ­£åœ¨ä½¿ç”¨ä¸­çš„å›¾ç‰‡ä½¿ç”¨å¼±å¼•ç”¨æ¥è¿›è¡Œç¼“å­˜ï¼Œä¸åœ¨ä½¿ç”¨ä¸­çš„å›¾ç‰‡ä½¿ç”¨LruCacheæ¥è¿›è¡Œç¼“å­˜çš„åŠŸèƒ½ã€‚<br>ä¸Šé¢ç£ç›˜ç¼“å­˜åˆ†æä¸­æˆ‘ä»¬çŸ¥é“ï¼Œå½“å›¾ç‰‡èµ„æºåŠ è½½åˆ°DecodeJobè¿™ä¸ªç±»ä¸­ï¼Œä»»åŠ¡æ˜¯æœ‰EngineJobçº¿ç¨‹æ± å»æ‰§è¡Œçš„ï¼Œå‡è®¾æˆ‘ä»¬å°†ç¼“å­˜ç­–ç•¥è®¾ç½®ä¸º DiskCacheStrategy.ALL åˆ†æä¸‹æºç ä¸­æ˜¯å¦‚ä½•æ‰§è¡Œçš„ï¼Œä¸‹é¢å…ˆçœ‹runWrappedæ–¹æ³•ï¼š</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">runWrapped</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (runReason) &#123;</span><br><span class="line">      <span class="keyword">case</span> INITIALIZE:</span><br><span class="line">        stage = getNextStage(Stage.INITIALIZE);</span><br><span class="line">        currentGenerator = getNextGenerator();</span><br><span class="line">        runGenerators();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> SWITCH_TO_SOURCE_SERVICE:</span><br><span class="line">        runGenerators();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> DECODE_DATA:</span><br><span class="line">        decodeFromRetrievedData();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalStateException</span>(<span class="string">&quot;Unrecognized run reason: &quot;</span> + runReason);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šç”±äºæˆ‘ä»¬çš„ç­–ç•¥ä¸ºDiskCacheStrategy.ALL æ‰€ä»¥diskCacheStrategy.decodeCachedResource() ä¸ºtrueï¼Œå³ä¼šè§£æè§£ç çš„æµç¨‹ï¼Œæ‰€ä»¥ State è¢«èµ‹å€¼ä¸º Stage.RESOURCE_CACHEï¼Œå¦‚ä¸‹ï¼š<br>è¿›å…¥getNextStageæ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> Stage <span class="title function_">getNextStage</span><span class="params">(Stage current)</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> (current) &#123;</span><br><span class="line">      <span class="keyword">case</span> INITIALIZE:</span><br><span class="line">        <span class="keyword">return</span> diskCacheStrategy.decodeCachedResource()</span><br><span class="line">            ? Stage.RESOURCE_CACHE</span><br><span class="line">            : getNextStage(Stage.RESOURCE_CACHE);</span><br><span class="line">      <span class="keyword">case</span> RESOURCE_CACHE:</span><br><span class="line">        <span class="keyword">return</span> diskCacheStrategy.decodeCachedData()</span><br><span class="line">            ? Stage.DATA_CACHE</span><br><span class="line">            : getNextStage(Stage.DATA_CACHE);</span><br><span class="line">      <span class="keyword">case</span> DATA_CACHE:</span><br><span class="line">        <span class="comment">// Skip loading from source if the user opted to only retrieve the resource from cache.</span></span><br><span class="line">        <span class="keyword">return</span> onlyRetrieveFromCache ? Stage.FINISHED : Stage.SOURCE;</span><br><span class="line">      <span class="keyword">case</span> SOURCE:</span><br><span class="line">      <span class="keyword">case</span> FINISHED:</span><br><span class="line">        <span class="keyword">return</span> Stage.FINISHED;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;Unrecognized stage: &quot;</span> + current);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šcurrentGenerator = getNextGenerator() æ‹¿åˆ°å½“å‰çš„è§£ç å™¨ä¸º ResourceCacheGeneratorç„¶å è°ƒç”¨ runGenerators() æ–¹æ³•ã€‚çœ‹ä¸‹é‡Œé¢å…·ä½“å®ç°ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">runGenerators</span><span class="params">()</span> &#123;</span><br><span class="line">    currentThread = Thread.currentThread();</span><br><span class="line">    startFetchTime = LogTime.getLogTime();</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">isStarted</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">while</span> (!isCancelled</span><br><span class="line">        &amp;&amp; currentGenerator != <span class="literal">null</span></span><br><span class="line">        &amp;&amp; !(isStarted = currentGenerator.startNext())) &#123;</span><br><span class="line">      stage = getNextStage(stage);</span><br><span class="line">      currentGenerator = getNextGenerator();</span><br><span class="line"></span><br><span class="line">      <span class="comment">//stage == Stage.SOURCE)æ—¶é€€å‡º,å¹¶è°ƒç”¨reschedule</span></span><br><span class="line">      <span class="keyword">if</span> (stage == Stage.SOURCE) &#123;</span><br><span class="line">        reschedule();</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// We&#x27;ve run out of stages and generators, give up.</span></span><br><span class="line">    <span class="keyword">if</span> ((stage == Stage.FINISHED || isCancelled) &amp;&amp; !isStarted) &#123;</span><br><span class="line">      notifyFailed();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Otherwise a generator started a new load and we expect to be called back in</span></span><br><span class="line">    <span class="comment">// onDataFetcherReady.</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šwhileå¾ªç¯ä¸æ–­é€šè¿‡startNext()è§£æä¸åŒçš„ç¼“å­˜ç­–ç•¥ï¼Œç›´åˆ°stage == Stage.SOURCE åé€€å‡ºã€‚</p>
<p>ä¸‹é¢è¿›å…¥startNextçœ‹ä¸‹æºç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"> <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">startNext</span><span class="params">()</span> &#123;</span><br><span class="line">   List&lt;Key&gt; sourceIds = helper.getCacheKeys();</span><br><span class="line">   ...</span><br><span class="line"> <span class="comment">//ç”±äºç¬¬ä¸€æ¬¡æ‹¿ä¸åˆ°keyï¼Œwhileä¼šä¸€ç›´æŸ¥æ‰¾</span></span><br><span class="line">   <span class="keyword">while</span> (modelLoaders == <span class="literal">null</span> || !hasNextModelLoader()) &#123;</span><br><span class="line">     resourceClassIndex++;</span><br><span class="line">     <span class="keyword">if</span> (resourceClassIndex &gt;= resourceClasses.size()) &#123;</span><br><span class="line">       sourceIdIndex++;</span><br><span class="line">   <span class="comment">//ç›´åˆ°è¿”å›false</span></span><br><span class="line">       <span class="keyword">if</span> (sourceIdIndex &gt;= sourceIds.size()) &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       resourceClassIndex = <span class="number">0</span>;</span><br><span class="line">     &#125;</span><br><span class="line"></span><br><span class="line">     <span class="type">Key</span> <span class="variable">sourceId</span> <span class="operator">=</span> sourceIds.get(sourceIdIndex);</span><br><span class="line">    ...</span><br><span class="line">     currentKey =</span><br><span class="line">         <span class="keyword">new</span> <span class="title class_">ResourceCacheKey</span>( <span class="comment">// NOPMD AvoidInstantiatingObjectsInLoops</span></span><br><span class="line">             helper.getArrayPool(),</span><br><span class="line">             sourceId,</span><br><span class="line">             helper.getSignature(),</span><br><span class="line">             helper.getWidth(),</span><br><span class="line">             helper.getHeight(),</span><br><span class="line">             transformation,</span><br><span class="line">             resourceClass,</span><br><span class="line">             helper.getOptions());</span><br><span class="line">     cacheFile = helper.getDiskCache().get(currentKey);</span><br><span class="line">     <span class="keyword">if</span> (cacheFile != <span class="literal">null</span>) &#123;</span><br><span class="line">       sourceKey = sourceId;</span><br><span class="line">       modelLoaders = helper.getModelLoaders(cacheFile);</span><br><span class="line">       modelLoaderIndex = <span class="number">0</span>;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   loadData = <span class="literal">null</span>;</span><br><span class="line">   <span class="type">boolean</span> <span class="variable">started</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">   <span class="keyword">while</span> (!started &amp;&amp; hasNextModelLoader()) &#123;</span><br><span class="line">     ModelLoader&lt;File, ?&gt; modelLoader = modelLoaders.get(modelLoaderIndex++);</span><br><span class="line">     loadData =</span><br><span class="line">         modelLoader.buildLoadData(</span><br><span class="line">             cacheFile, helper.getWidth(), helper.getHeight(), helper.getOptions());</span><br><span class="line">     <span class="keyword">if</span> (loadData != <span class="literal">null</span> &amp;&amp; helper.hasLoadPath(loadData.fetcher.getDataClass())) &#123;</span><br><span class="line">       started = <span class="literal">true</span>;</span><br><span class="line">       loadData.fetcher.loadData(helper.getPriority(), <span class="built_in">this</span>);</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">return</span> started;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢çœ‹ä¸‹reschedule()æ–¹æ³•æºç ï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reschedule</span><span class="params">()</span> &#123;</span><br><span class="line">  runReason = RunReason.SWITCH_TO_SOURCE_SERVICE;</span><br><span class="line">  callback.reschedule(<span class="built_in">this</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šé‡å¤è°ƒç”¨ runWrapped() æ–¹æ³•ï¼Œä½†æ­¤æ—¶çš„ runReason å·²ç»å˜æˆäº† SWITCH_TO_SOURCE_SERVICEï¼Œæ‰€ä»¥å®ƒä¼šæ‰§è¡Œ runGenerators() æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">runGenerators</span><span class="params">()</span> &#123;</span><br><span class="line">   currentThread = Thread.currentThread();</span><br><span class="line">   startFetchTime = LogTime.getLogTime();</span><br><span class="line">   <span class="type">boolean</span> <span class="variable">isStarted</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">   <span class="keyword">while</span> (!isCancelled</span><br><span class="line">       &amp;&amp; currentGenerator != <span class="literal">null</span></span><br><span class="line">       &amp;&amp; !(isStarted = currentGenerator.startNext())) &#123;</span><br><span class="line">     stage = getNextStage(stage);</span><br><span class="line">     currentGenerator = getNextGenerator();</span><br><span class="line"></span><br><span class="line">     <span class="keyword">if</span> (stage == Stage.SOURCE) &#123;</span><br><span class="line">       reschedule();</span><br><span class="line">       <span class="keyword">return</span>;</span><br><span class="line">     &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span> ((stage == Stage.FINISHED || isCancelled) &amp;&amp; !isStarted) &#123;</span><br><span class="line">     notifyFailed();</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>æ³¨ï¼šæ­¤æ—¶ currentGenerator ä¸º SourceGennerator å·²ç»ä¸ä¸ºnullã€‚</p>
<p>æ¥ç€çœ‹SourceGenneratorç±»ä¸­startNextï¼š</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">startNext</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (dataToCache != <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="type">Object</span> <span class="variable">data</span> <span class="operator">=</span> dataToCache;</span><br><span class="line">      dataToCache = <span class="literal">null</span>;</span><br><span class="line">      <span class="comment">// å­˜å‚¨åˆ° DiskLruCache</span></span><br><span class="line">      cacheData(data);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (sourceCacheGenerator != <span class="literal">null</span> &amp;&amp; sourceCacheGenerator.startNext()) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sourceCacheGenerator = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    loadData = <span class="literal">null</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">started</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">while</span> (!started &amp;&amp; hasNextModelLoader()) &#123;</span><br><span class="line">      loadData = helper.getLoadData().get(loadDataListIndex++);</span><br><span class="line">      <span class="keyword">if</span> (loadData != <span class="literal">null</span></span><br><span class="line">          &amp;&amp; (helper.getDiskCacheStrategy().isDataCacheable(loadData.fetcher.getDataSource())</span><br><span class="line">              || helper.hasLoadPath(loadData.fetcher.getDataClass()))) &#123;</span><br><span class="line">        started = <span class="literal">true</span>;</span><br><span class="line">        /åŠ è½½æ•°æ®</span><br><span class="line">        startNextLoad(loadData);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> started;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>ç¡¬ç›˜ç¼“å­˜æ—¶é€šè¿‡åœ¨ EngineJob ä¸­çš„ DecodeJob ä¸­å®Œæˆçš„ï¼Œå…ˆé€šè¿‡ResourcesCacheGeneratorã€DataCacheGenerator çœ‹æ˜¯å¦èƒ½ä» DiskLruCache æ‹¿åˆ°æ•°æ®ï¼Œå¦‚æœä¸èƒ½ï¼Œä»SourceGeneratorå»è§£ææ•°æ®ï¼Œå¹¶æŠŠæ•°æ®å­˜å‚¨åˆ° DiskLruCache ä¸­ï¼Œåé¢é€šè¿‡ DataCacheGenerator çš„ startNext() å»åˆ†å‘ fetcher ã€‚<br>æœ€åä¼šå›è°ƒ EngineJob çš„ onResourceReady() æ–¹æ³•äº†ï¼Œè¯¥æ–¹æ³•ä¼šåŠ è½½å›¾ç‰‡ï¼Œå¹¶æŠŠæ•°æ®å­˜åˆ°å¼±å¼•ç”¨ä¸­</p>
</blockquote>
]]></content>
      <categories>
        <category>Android</category>
      </categories>
      <tags>
        <tag>Android</tag>
      </tags>
  </entry>
  <entry>
    <title>LinkedHashMap-åŸç†åˆ†æ</title>
    <url>/relaxed/LinkedHashMap-%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>LinkedHashMap æ˜¯å¦‚ä½•åšåˆ°LruCache ï¼Œä¸‹é¢æˆ‘ä»¬ä»æºç ä¸­çœ‹ä¸€çœ‹</p>
<h2 id="LinkedHashMapæ„é€ å‡½æ•°"><a href="#LinkedHashMapæ„é€ å‡½æ•°" class="headerlink" title="LinkedHashMapæ„é€ å‡½æ•°"></a>LinkedHashMapæ„é€ å‡½æ•°</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructs an empty insertion-ordered &lt;tt&gt;LinkedHashMap&lt;/tt&gt; instance</span></span><br><span class="line"><span class="comment">     * with the specified initial capacity and load factor.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  initialCapacity the initial capacity</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  loadFactor      the load factor</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalArgumentException if the initial capacity is negative</span></span><br><span class="line"><span class="comment">     *         or the load factor is nonpositive</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedHashMap</span><span class="params">(<span class="type">int</span> initialCapacity, <span class="type">float</span> loadFactor)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(initialCapacity, loadFactor);</span><br><span class="line">        accessOrder = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructs an empty insertion-ordered &lt;tt&gt;LinkedHashMap&lt;/tt&gt; instance</span></span><br><span class="line"><span class="comment">     * with the specified initial capacity and a default load factor (0.75).</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  initialCapacity the initial capacity</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalArgumentException if the initial capacity is negative</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedHashMap</span><span class="params">(<span class="type">int</span> initialCapacity)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(initialCapacity);</span><br><span class="line">        accessOrder = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructs an empty insertion-ordered &lt;tt&gt;LinkedHashMap&lt;/tt&gt; instance</span></span><br><span class="line"><span class="comment">     * with the default initial capacity (16) and load factor (0.75).</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedHashMap</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        accessOrder = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructs an insertion-ordered &lt;tt&gt;LinkedHashMap&lt;/tt&gt; instance with</span></span><br><span class="line"><span class="comment">     * the same mappings as the specified map.  The &lt;tt&gt;LinkedHashMap&lt;/tt&gt;</span></span><br><span class="line"><span class="comment">     * instance is created with a default load factor (0.75) and an initial</span></span><br><span class="line"><span class="comment">     * capacity sufficient to hold the mappings in the specified map.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  m the map whose mappings are to be placed in this map</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NullPointerException if the specified map is null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedHashMap</span><span class="params">(Map&lt;? extends K, ? extends V&gt; m)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        accessOrder = <span class="literal">false</span>;</span><br><span class="line">        putMapEntries(m, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructs an empty &lt;tt&gt;LinkedHashMap&lt;/tt&gt; instance with the</span></span><br><span class="line"><span class="comment">     * specified initial capacity, load factor and ordering mode.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  initialCapacity the initial capacity</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  loadFactor      the load factor</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  accessOrder     the ordering mode - &lt;tt&gt;true&lt;/tt&gt; for</span></span><br><span class="line"><span class="comment">     *         access-order, &lt;tt&gt;false&lt;/tt&gt; for insertion-order</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalArgumentException if the initial capacity is negative</span></span><br><span class="line"><span class="comment">     *         or the load factor is nonpositive</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">LinkedHashMap</span><span class="params">(<span class="type">int</span> initialCapacity,</span></span><br><span class="line"><span class="params">                         <span class="type">float</span> loadFactor,</span></span><br><span class="line"><span class="params">                         <span class="type">boolean</span> accessOrder)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(initialCapacity, loadFactor);</span><br><span class="line">        <span class="built_in">this</span>.accessOrder = accessOrder;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>å…ˆåˆ†åˆ«çœ‹ä¸‹è¿™ä¸‰ä¸ªå‚æ•°ï¼šint initialCapacityã€float loadFactor, boolean accessOrder</p>
<p>initialCapacityï¼šè¡¨ç¤ºæ˜¯åˆå§‹æ•°ç»„é•¿åº¦</p>
<p>loadFactorï¼šè¡¨ç¤ºè´Ÿè½½å› å­ï¼Œè¡¨ç¤ºæ•°ç»„çš„å…ƒç´ æ•°é‡/æ•°ç»„é•¿åº¦è¶…è¿‡è¿™ä¸ªæ¯”ä¾‹ï¼Œæ•°ç»„å°±è¦æ‰©å®¹</p>
<p>accessOrderï¼šfalseï¼š åŸºäºæ’å…¥é¡ºåº(é»˜è®¤) trueï¼š åŸºäºè®¿é—®é¡ºåº</p>
<p>å…³äºæ’å…¥é¡ºåºï¼Œè®¿é—®é¡ºåºå¯ä»¥çœ‹æˆ‘çš„å¦ä¸€ç¯‡æ–‡ç« ï¼š <a href="/relaxed/java-%E9%93%BE%E8%A1%A8/" title="javaé“¾è¡¨(å•å‘ï¼Œå¾ªç¯ã€åŒå‘)">javaé“¾è¡¨(å•å‘ï¼Œå¾ªç¯ã€åŒå‘)</a></p>
<p>ä¸‹é¢çœ‹ä¸‹LinkedHashMap æœ€å¸¸ç”¨çš„getï¼Œput ä»¥åŠafterNodeAccessã€afterNodeInsertionæ–¹æ³•</p>
<h2 id="get"><a href="#get" class="headerlink" title="get"></a>get</h2><p>LinkedHashMap é‡å†™äº†getæ–¹æ³•ï¼Œå®ç°äº†LrucaChe</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**Returns the value to which the specified key is mapped, or null if this map contains no mapping for the key.</span></span><br><span class="line"><span class="comment">More formally, if this map contains a mapping from a key k to a value v such that (key==null ? k==null : key.equals(k)), then this method returns v; otherwise it returns null. (There can be at most one such mapping.)</span></span><br><span class="line"><span class="comment">A return value of null does not necessarily indicate that the map contains no mapping for the key; it&#x27;s also possible that the map explicitly maps the key to null. The containsKey operation may be used to distinguish these two cases*/</span></span><br><span class="line">&lt;P&gt;</span><br><span class="line">è¿”å›æŒ‡å®šé”®æ˜ å°„åˆ°çš„å€¼ï¼Œå¦‚æœæ­¤æ˜ å°„ä¸åŒ…å«è¯¥é”®çš„æ˜ å°„ï¼Œåˆ™è¿”å›<span class="literal">null</span>ã€‚</span><br><span class="line">æ›´æ­£å¼åœ°è¯´ï¼Œå¦‚æœè¿™ä¸ªæ˜ å°„åŒ…å«ä»é”®kåˆ°å€¼vçš„æ˜ å°„ï¼Œä½¿å¾—ï¼ˆé”®==<span class="literal">null</span>ï¼Ÿk==<span class="literal">null</span>:key.equalsï¼ˆkï¼‰ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•è¿”å›vï¼›å¦åˆ™è¿”å›<span class="literal">null</span>ã€‚ï¼ˆæœ€å¤šå¯ä»¥æœ‰ä¸€ä¸ªè¿™æ ·çš„æ˜ å°„ã€‚ï¼‰</span><br><span class="line">ç©ºæ˜ å°„ä¸ä¸€å®šåŒ…å«ç©ºæ˜ å°„çš„è¿”å›å€¼ï¼›æ˜ å°„ä¹Ÿå¯èƒ½æ˜¾å¼åœ°å°†å¯†é’¥æ˜ å°„ä¸º<span class="literal">null</span>ã€‚containsKeyæ“ä½œå¯ç”¨äºåŒºåˆ†è¿™ä¸¤ç§æƒ…å†µ</span><br><span class="line">&lt;/p&gt;</span><br><span class="line"><span class="keyword">public</span> V <span class="title function_">get</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">        Node&lt;K,V&gt; e;</span><br><span class="line">        <span class="keyword">if</span> ((e = getNode(hash(key), key)) == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">// accessOderä¸ºtrueæ—¶ï¼Œè¢«è®¿é—®çš„èŠ‚ç‚¹è¢«ç½®äºåŒå‘é“¾è¡¨å°¾éƒ¨</span></span><br><span class="line">        <span class="keyword">if</span> (accessOrder)</span><br><span class="line">            afterNodeAccess(e);</span><br><span class="line">        <span class="keyword">return</span> e.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**Returns the value to which the specified key is mapped, or defaultValue if this map contains no mapping for the key.*/</span></span><br><span class="line">&lt;p&gt;è¿”å›æŒ‡å®šé”®æ˜ å°„åˆ°çš„å€¼ï¼Œå¦‚æœæ­¤æ˜ å°„ä¸åŒ…å«è¯¥é”®çš„æ˜ å°„ï¼Œåˆ™è¿”å›defaultValueã€‚&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> V <span class="title function_">getOrDefault</span><span class="params">(Object key, V defaultValue)</span> &#123;</span><br><span class="line">       Node&lt;K,V&gt; e;</span><br><span class="line">       <span class="keyword">if</span> ((e = getNode(hash(key), key)) == <span class="literal">null</span>)</span><br><span class="line">           <span class="keyword">return</span> defaultValue;</span><br><span class="line">       <span class="keyword">if</span> (accessOrder)</span><br><span class="line">           afterNodeAccess(e);</span><br><span class="line">       <span class="keyword">return</span> e.value;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°åœ¨get æ–¹æ³•ä¸­è°ƒç”¨äº†afterNodeAccessæ–¹æ³•ï¼Œä¸‹é¢çœ‹ä¸‹è¿™ä¸ªæ–¹æ³•å¹²äº†ä»€ä¹ˆ</p>
<h2 id="afterNodeAccess"><a href="#afterNodeAccess" class="headerlink" title="afterNodeAccess"></a>afterNodeAccess</h2><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">afterNodeAccess</span><span class="params">(Node&lt;K,V&gt; e)</span> &#123; <span class="comment">// move node to last</span></span><br><span class="line">    <span class="comment">// ç”¨ last è¡¨ç¤ºæ’å…¥ e å‰çš„å°¾èŠ‚ç‚¹</span></span><br><span class="line">    <span class="comment">// æ’å…¥ e å e æ˜¯å°¾èŠ‚ç‚¹, æ‰€ä»¥ä¹Ÿæ˜¯è¡¨ç¤º e çš„å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">    LinkedHashMap.Entry&lt;K,V&gt; last;</span><br><span class="line">    <span class="comment">//å¦‚æœæ˜¯è®¿é—®åºï¼Œä¸”å½“å‰èŠ‚ç‚¹å¹¶ä¸æ˜¯å°¾èŠ‚ç‚¹</span></span><br><span class="line">    <span class="comment">//å°†è¯¥èŠ‚ç‚¹ç½®ä¸ºåŒå‘é“¾è¡¨çš„å°¾éƒ¨</span></span><br><span class="line">    <span class="keyword">if</span> (accessOrder &amp;&amp; (last = tail) != e) &#123;</span><br><span class="line">        <span class="comment">// p: å½“å‰èŠ‚ç‚¹</span></span><br><span class="line">        <span class="comment">// b: å‰ä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        <span class="comment">// a: åä¸€ä¸ªèŠ‚ç‚¹</span></span><br><span class="line">        LinkedHashMap.Entry&lt;K,V&gt; p =</span><br><span class="line">            (LinkedHashMap.Entry&lt;K,V&gt;)e, b = p.before, a = p.after;</span><br><span class="line">        <span class="comment">// å› ä¸ºè¦ç§»åŠ¨åˆ°é“¾å°¾ï¼Œæ‰€ä»¥å…ˆè‡³å°¾æŒ‡é’ˆä¸ºç©º</span></span><br><span class="line">        p.after = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¦‚æœå‰é¢æ²¡æœ‰å…ƒç´ ï¼Œåˆ™pä¹‹å‰ä¸ºå¤´ç»“ç‚¹ï¼Œç›´æ¥è®©aæˆä¸ºå¤´ç»“ç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (b == <span class="literal">null</span>)</span><br><span class="line">            head = a;</span><br><span class="line">        <span class="comment">// å¦åˆ™bçš„å°¾æŒ‡é’ˆæŒ‡å‘a</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            b.after = a;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (a != <span class="literal">null</span>)</span><br><span class="line">        <span class="comment">//å¦‚æœaä¸ä¸ºç©ºï¼Œåˆ™açš„å¤´æŒ‡é’ˆæŒ‡å‘b</span></span><br><span class="line">            a.before = b;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        <span class="comment">//å¦åˆ™ pä¹‹å‰å°±ä¸ºå°¾æŒ‡é’ˆï¼Œåˆ™å¦bæˆä¸ºå°¾æŒ‡é’ˆ</span></span><br><span class="line">            last = b;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (last == <span class="literal">null</span>)</span><br><span class="line">            head = p;</span><br><span class="line">        <span class="comment">//å¦‚æœåŒå‘é“¾è¡¨ä¸­åªæœ‰pä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™ä»¤på³ä¸ºå¤´ç»“ç‚¹ï¼Œä¹Ÿä¸ºå°¾èŠ‚ç‚¹</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//å¦åˆ™ å°†pæ’å…¥é“¾å°¾</span></span><br><span class="line">            p.before = last;</span><br><span class="line">            last.after = p;</span><br><span class="line">        &#125;</span><br><span class="line">        tail = p;</span><br><span class="line">        ++modCount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="put"><a href="#put" class="headerlink" title="put"></a>put</h2><p>LinkedHashMap å¹¶æ²¡æœ‰é‡å†™HashMapçš„ put æ–¹æ³•ï¼Œè°ƒç”¨çš„è¿˜æ˜¯HashMapå¾—putæ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Associates the specified value with the specified key in this map.</span></span><br><span class="line"><span class="comment">     * If the map previously contained a mapping for the key, the old</span></span><br><span class="line"><span class="comment">     * value is replaced.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key key with which the specified value is to be associated</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value value to be associated with the specified key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the previous value associated with &lt;tt&gt;key&lt;/tt&gt;, or</span></span><br><span class="line"><span class="comment">     *         &lt;tt&gt;null&lt;/tt&gt; if there was no mapping for &lt;tt&gt;key&lt;/tt&gt;.</span></span><br><span class="line"><span class="comment">     *         (A &lt;tt&gt;null&lt;/tt&gt; return can also indicate that the map</span></span><br><span class="line"><span class="comment">     *         previously associated &lt;tt&gt;null&lt;/tt&gt; with &lt;tt&gt;key&lt;/tt&gt;.)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">put</span><span class="params">(K key, V value)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> putVal(hash(key), key, value, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Implements Map.put and related methods.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> hash hash for key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key the key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value the value to put</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> onlyIfAbsent if true, don&#x27;t change existing value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> evict if false, the table is in creation mode.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> previous value, or null if none</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">final</span> V <span class="title function_">putVal</span><span class="params">(<span class="type">int</span> hash, K key, V value, <span class="type">boolean</span> onlyIfAbsent,</span></span><br><span class="line"><span class="params">                   <span class="type">boolean</span> evict)</span> &#123;</span><br><span class="line">        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="type">int</span> n, i;</span><br><span class="line">        <span class="keyword">if</span> ((tab = table) == <span class="literal">null</span> || (n = tab.length) == <span class="number">0</span>)</span><br><span class="line">            n = (tab = resize()).length;</span><br><span class="line">        <span class="keyword">if</span> ((p = tab[i = (n - <span class="number">1</span>) &amp; hash]) == <span class="literal">null</span>)</span><br><span class="line">            tab[i] = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            Node&lt;K,V&gt; e; K k;</span><br><span class="line">            <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">                ((k = p.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                e = p;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(<span class="built_in">this</span>, tab, hash, key, value);</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">binCount</span> <span class="operator">=</span> <span class="number">0</span>; ; ++binCount) &#123;</span><br><span class="line">                    <span class="keyword">if</span> ((e = p.next) == <span class="literal">null</span>) &#123;</span><br><span class="line">                        p.next = newNode(hash, key, value, <span class="literal">null</span>);</span><br><span class="line">                        <span class="keyword">if</span> (binCount &gt;= TREEIFY_THRESHOLD - <span class="number">1</span>) <span class="comment">// -1 for 1st</span></span><br><span class="line">                            treeifyBin(tab, hash);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                        ((k = e.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    p = e;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123; <span class="comment">// existing mapping for key</span></span><br><span class="line">                <span class="type">V</span> <span class="variable">oldValue</span> <span class="operator">=</span> e.value;</span><br><span class="line">                <span class="keyword">if</span> (!onlyIfAbsent || oldValue == <span class="literal">null</span>)</span><br><span class="line">                    e.value = value;</span><br><span class="line">                afterNodeAccess(e);</span><br><span class="line">                <span class="keyword">return</span> oldValue;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ++modCount;</span><br><span class="line">        <span class="keyword">if</span> (++size &gt; threshold)</span><br><span class="line">            resize();</span><br><span class="line">        afterNodeInsertion(evict);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤å¤–HashMapçš„putVal()æ–¹æ³•ï¼Œè¿˜è°ƒç”¨äº†afterNodeInsertion()æ–¹æ³•ï¼Œ</p>
<h2 id="afterNodeInsertion"><a href="#afterNodeInsertion" class="headerlink" title="afterNodeInsertion"></a>afterNodeInsertion</h2><p>å½“æ’å…¥æ•°æ®æ—¶ï¼Œå°†åŒå‘é“¾è¡¨çš„å¤´ç»“ç‚¹ç§»é™¤ï¼Œè¿™å‡ ä¸ªæ–¹æ³•è®©LinkedHashMapå®ç°äº†LRUç®—æ³•ã€‚ä¸è¿‡removeEldestEntry()é»˜è®¤æ˜¯è¿”å›falseçš„ï¼Œéœ€è¦å­ç±»ç»§æ‰¿é‡å†™removeEldestEntry()æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">afterNodeInsertion</span><span class="params">(<span class="type">boolean</span> evict)</span> &#123; <span class="comment">// possibly remove eldest</span></span><br><span class="line">        LinkedHashMap.Entry&lt;K,V&gt; first;</span><br><span class="line">        <span class="keyword">if</span> (evict &amp;&amp; (first = head) != <span class="literal">null</span> &amp;&amp; removeEldestEntry(first)) &#123;</span><br><span class="line">            <span class="type">K</span> <span class="variable">key</span> <span class="operator">=</span> first.key;</span><br><span class="line">            removeNode(hash(key), key, <span class="literal">null</span>, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>LinkedHashMapçš„remove()æ–¹æ³•ä¹Ÿæ˜¯è°ƒç”¨çš„HashMapçš„remove()æ–¹æ³•ï¼Œ</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Removes the mapping for the specified key from this map if present.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span>  key key whose mapping is to be removed from the map</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the previous value associated with &lt;tt&gt;key&lt;/tt&gt;, or</span></span><br><span class="line"><span class="comment">     *         &lt;tt&gt;null&lt;/tt&gt; if there was no mapping for &lt;tt&gt;key&lt;/tt&gt;.</span></span><br><span class="line"><span class="comment">     *         (A &lt;tt&gt;null&lt;/tt&gt; return can also indicate that the map</span></span><br><span class="line"><span class="comment">     *         previously associated &lt;tt&gt;null&lt;/tt&gt; with &lt;tt&gt;key&lt;/tt&gt;.)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> V <span class="title function_">remove</span><span class="params">(Object key)</span> &#123;</span><br><span class="line">        Node&lt;K,V&gt; e;</span><br><span class="line">        <span class="keyword">return</span> (e = removeNode(hashLkey), key, <span class="literal">null</span>, <span class="literal">false</span>, <span class="literal">true</span>)) == <span class="literal">null</span> ?</span><br><span class="line">            <span class="literal">null</span> : e.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Implements Map.remove and related methods.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> hash hash for key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key the key</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value the value to match if matchValue, else ignored</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> matchValue if true only remove if value is equal</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> movable if false do not move other nodes while removing</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the node, or null if none</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">final</span> Node&lt;K,V&gt; <span class="title function_">removeNode</span><span class="params">(<span class="type">int</span> hash, Object key, Object value,</span></span><br><span class="line"><span class="params">                               <span class="type">boolean</span> matchValue, <span class="type">boolean</span> movable)</span> &#123;</span><br><span class="line">        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; <span class="type">int</span> n, index;</span><br><span class="line">        <span class="keyword">if</span> ((tab = table) != <span class="literal">null</span> &amp;&amp; (n = tab.length) &gt; <span class="number">0</span> &amp;&amp;</span><br><span class="line">            (p = tab[index = (n - <span class="number">1</span>) &amp; hash]) != <span class="literal">null</span>) &#123;</span><br><span class="line">            Node&lt;K,V&gt; node = <span class="literal">null</span>, e; K k; V v;</span><br><span class="line">            <span class="keyword">if</span> (p.hash == hash &amp;&amp;</span><br><span class="line">                ((k = p.key) == key || (key != <span class="literal">null</span> &amp;&amp; key.equals(k))))</span><br><span class="line">                node = p;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> ((e = p.next) != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (p <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                    node = ((TreeNode&lt;K,V&gt;)p).getTreeNode(hash, key);</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">do</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (e.hash == hash &amp;&amp;</span><br><span class="line">                            ((k = e.key) == key ||</span><br><span class="line">                             (key != <span class="literal">null</span> &amp;&amp; key.equals(k)))) &#123;</span><br><span class="line">                            node = e;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        p = e;</span><br><span class="line">                    &#125; <span class="keyword">while</span> ((e = e.next) != <span class="literal">null</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (node != <span class="literal">null</span> &amp;&amp; (!matchValue || (v = node.value) == value ||</span><br><span class="line">                                 (value != <span class="literal">null</span> &amp;&amp; value.equals(v)))) &#123;</span><br><span class="line">                <span class="keyword">if</span> (node <span class="keyword">instanceof</span> TreeNode)</span><br><span class="line">                    ((TreeNode&lt;K,V&gt;)node).removeTreeNode(<span class="built_in">this</span>, tab, movable);</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (node == p)</span><br><span class="line">                    tab[index] = node.next;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    p.next = node.next;</span><br><span class="line">                ++modCount;</span><br><span class="line">                --size;</span><br><span class="line">                afterNodeRemoval(node);</span><br><span class="line">                <span class="keyword">return</span> node;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æ€»ç»“ï¼š</p>
<ul>
<li>  LinkedHashMap ç»§æ‰¿ HashMapï¼Œæ‹¥æœ‰ HashMap çš„åŠŸèƒ½</li>
<li>  LinkedHashMap ç»´æŠ¤äº†ä¸¤ä¸ªæ•°æ®ç»“æ„ï¼Œä¸€æ˜¯ HashMap çš„ç»“æ„ï¼ŒäºŒæ˜¯ç”¨æ¥åšè¿­ä»£çš„åŒå‘é“¾è¡¨</li>
<li>  LinkedHashMap ç‹¬ç‰¹çš„è¿­ä»£å™¨è®¾è®¡å’Œä¸€äº›å‡½æ•°çš„é‡å†™ï¼Œå¯¼è‡´è¿­ä»£å™¨æŒ‰åŒå‘é“¾è¡¨è¿­ä»£ï¼Œå¹¶ä¸”è‹¥æ²¡æœ‰è®¾ç½® accessOrderï¼Œåˆ™æŒ‰æ’å…¥é¡ºåºè¿­ä»£ï¼Œå¦åˆ™ï¼ŒæŒ‰è®¿é—®é¡ºåºè¿­ä»£</li>
<li>  é€šè¿‡é‡å†™removeEldestEntryå¯ä»¥å®ç° LruCache çš„åŠŸèƒ½</li>
</ul>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>LruCache-åŸç†åˆ†æ</title>
    <url>/relaxed/LruCache-%E5%8E%9F%E7%90%86%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<p>1.LruCacheåŸç†æ˜¯ä»€ä¹ˆ<br> LruCache é‡‡ç”¨æœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•ï¼Œè®¾å®šä¸€ä¸ªç¼“å­˜å¤§å°ï¼Œå½“ç¼“å­˜è¾¾åˆ°è¿™ä¸ªå¤§å°ä¹‹åï¼Œä¼šå°†æœ€è€çš„æ•°æ®ç§»é™¤ï¼Œé¿å…å›¾ç‰‡å ç”¨å†…å­˜è¿‡å¤§å¯¼è‡´OOMã€‚</p>
<p>2.Lrucacheæºç åˆ†æ<br> <figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LruCache</span>&lt;K, V&gt; &#123;</span><br><span class="line">	<span class="comment">// æ•°æ®æœ€ç»ˆå­˜åœ¨ LinkedHashMap ä¸­</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> LinkedHashMap&lt;K, V&gt; map;</span><br><span class="line">	...</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">LruCache</span><span class="params">(<span class="type">int</span> maxSize)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (maxSize &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalArgumentException</span>(<span class="string">&quot;maxSize &lt;= 0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.maxSize = maxSize;</span><br><span class="line">		<span class="comment">// åˆ›å»ºä¸€ä¸ªLinkedHashMapï¼ŒaccessOrder ä¼ true</span></span><br><span class="line">        <span class="built_in">this</span>.map = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;K, V&gt;(<span class="number">0</span>, <span class="number">0.75f</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><br>LruCache æ„é€ æ–¹æ³•é‡Œåˆ›å»ºä¸€ä¸ªLinkedHashMapï¼ŒaccessOrder å‚æ•°ä¼ trueï¼Œè¡¨ç¤ºè®¿é—®æ—¶é‡æ–°æ’åºï¼ŒaccessOrder å‚æ•°ä¼ falseï¼Œè¡¨ç¤ºæ’å…¥æ—¶é‡æ–°æ’åºã€‚ï¼ˆ/* LruCache æ ¸å¿ƒå·¥ä½œåŸç†å°±åœ¨æ­¤*/ï¼‰</p>
<p>æ’å…¥é¡ºåºæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ<br>æŒ‰ç…§å¯¹è±¡æ’å…¥çš„é¡ºåºè¿›è¡Œæ’åˆ—ï¼Œå¯ä»¥ç®€å•è¯´æŒ‰ç…§æ’å…¥çš„æ—¶é—´å…ˆåé¡ºåºæ’åˆ—ã€‚<br>ä¾æ¬¡æ”¾å…¥1,2,3,4,5   é‚£ä¹ˆæŒ‰ç…§æ’å…¥é¡ºåºåLruCacheä¸­çš„å¯¹è±¡é¡ºåºå°±æ˜¯1,2,3,4,5</p>
<p>é‚£ä¹ˆè®¿é—®é¡ºåºæ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ<br>è®¿é—®é¡ºåºæ„æ€å°±æ˜¯LruCacheä¸­è¢«è®¿é—®è¿‡çš„å­å¯¹è±¡ä¼šé‡æ–°æ’åºï¼Œé‚£ä¹ˆæ„å‘³ç€æˆ‘ä»¬å…ˆä¾æ¬¡æ’åºè¿›è¡Œå¯¹è±¡ç¼“å­˜1,2,3,4,5<br>ç°é˜¶æ®µçš„å¯¹è±¡é¡ºåºæ˜¯1,2,3,4,5<br>å¦‚æœç°åœ¨å†…å­˜ä½¿ç”¨äº†2å·ç¼“å­˜ï¼Œé‚£ä¹ˆå°±è¡¨ç¤º2å·è¢«è®¿é—®äº†ï¼Œé‡æ–°æ’åº 2,1,3,4,5<br>å¦‚æœç°åœ¨å†…å­˜å†å‘½ä¸­äº†4å·ç¼“å­˜ï¼Œé‚£ä¹ˆå°±è¡¨ç¤º4å·è¢«è®¿é—®äº†ï¼Œé‡æ–°æ’åº 4,2,1,3,5<br>å†…å­˜å†å‘½ä¸­äº†5å·ç¼“å­˜ï¼Œé‚£ä¹ˆå°±è¡¨ç¤º4å·è¢«è®¿é—®äº†ï¼Œé‡æ–°æ’åº 5,4,2,1,3<br>â€¦..<br>â€¦..</p>
<p>æ‰€ä»¥æ¯æ¬¡ä½¿ç”¨è¿‡çš„ç¼“å­˜éƒ½ä¼šè¢«é‡æ–°æ’åˆ°ç¼“å­˜é˜Ÿåˆ—çš„æœ€å‰é¢ã€‚</p>
<p>é‚£ä¹ˆæ„å‘³ç€ï¼Œé˜Ÿåˆ—è¶Šåé¢çš„ç¼“å­˜å°±ä½¿ç”¨å¾—è¶Šå°‘ï¼Œå½“ç¼“å­˜é˜Ÿåˆ—å®¹é‡è¾¾åˆ°é˜€å€¼åï¼Œå†å¾€é˜Ÿåˆ—ä¸­æ·»åŠ æ–°ç¼“å­˜æ—¶åˆ™å¯ä»¥å°†é˜Ÿåˆ—æœ€åé¢çš„ä½¿ç”¨æ¬¡æ•°æœ€å°‘çš„ç¼“å­˜ä¾æ¬¡ç§»é™¤ï¼Œæ’å…¥æ–°ç¼“å­˜ï¼Œè¾¾åˆ°Lruç®—æ³•çš„æ•ˆæœã€‚</p>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>Javaé«˜çº§ç‰¹æ€§-åå°„</title>
    <url>/relaxed/java-%E5%8F%8D%E5%B0%84/</url>
    <content><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p> <strong><a href="https://baike.baidu.com/item/JAVA%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/6015990">JAVAåå°„æœºåˆ¶</a>æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„æ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºjavaè¯­è¨€çš„åå°„æœºåˆ¶ã€‚</strong></p>
<h1 id="åº”ç”¨åœºæ™¯"><a href="#åº”ç”¨åœºæ™¯" class="headerlink" title="åº”ç”¨åœºæ™¯"></a>åº”ç”¨åœºæ™¯</h1><p>Androidä¸­æœ€ç†Ÿæ‚‰çš„åå°„ï¼Œè«è¿‡äºJsonæ•°æ®çš„è½¬æ¢ï¼Œä¾‹å¦‚ç½‘ç»œæ•°æ®ï¼Œæ•°æ®åº“æ•°æ®å’Œç±»ä¹‹é—´çš„ç›¸äº’è½¬åŒ–ã€‚ä½¿ç”¨åå°„æœºåˆ¶å¯ä»¥ç›´æ¥åˆ›å»ºå¯¹è±¡ï¼Œæ–¹ä¾¿ä»£ç ç®¡ç†ã€‚</p>
<h1 id="ç›¸å…³ç±»"><a href="#ç›¸å…³ç±»" class="headerlink" title="ç›¸å…³ç±»"></a>ç›¸å…³ç±»</h1><p><a href="https://developer.android.google.cn/reference/java/lang/Class">. Class</a></p>
<ul>
<li>classç±»ä¸‹éƒ¨åˆ†å¸¸ç”¨æ–¹æ³•</li>
</ul>
<table>
<thead>
<tr>
<th align="center">æ–¹æ³•å</th>
<th align="center">ç¿»è¯‘</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#forName(java.lang.String,%20boolean,%20java.lang.ClassLoader)">forName(String className)</a></td>
<td align="center">åŠ è½½å‚æ•°æŒ‡å®šçš„ç±»ï¼Œå¹¶ä¸”åˆå§‹åŒ–å®ƒã€‚</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#cast(java.lang.Object)">cast</a></td>
<td align="center">å¯¹è±¡è½¬æ¢æˆä»£è¡¨ç±»æˆ–æ˜¯æ¥å£çš„å¯¹è±¡</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#cast(java.lang.Object)">getClasses()</a></td>
<td align="center">è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­åŒ…å«è¯¥ç±»ä¸­æ‰€æœ‰å…¬å…±ç±»å’Œæ¥å£ç±»çš„å¯¹è±¡</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getName()">getName()</a></td>
<td align="center">è·å–ç±»è·¯å¾„åç§°</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#newInstance()">newInstance</a></td>
<td align="center">åˆ›å»ºç±»çš„å®ä¾‹</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getPackage()">getPackage()</a></td>
<td align="center">è·å–ç±»æ‰€åœ¨åŒ…</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getPackage()">getInterfaces()</a></td>
<td align="center">ç¡®å®šæ­¤å¯¹è±¡æ‰€è¡¨ç¤ºçš„ç±»æˆ–æ¥å£å®ç°çš„æ¥å£</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getSuperclass()">getSuperclass()</a></td>
<td align="center">è·å¾—å½“å‰ç±»ç»§æ‰¿çš„çˆ¶ç±»çš„åå­—</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getClassLoader()">getClassLoader()</a></td>
<td align="center">è·å–ç±»åŠ è½½å™¨</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getDeclaredClasses()">getDeclaredClasses()</a></td>
<td align="center">è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæ•°ç»„ä¸­åŒ…å«è¯¥ç±»ä¸­æ‰€æœ‰ç±»å’Œæ¥å£ç±»çš„å¯¹è±¡</td>
</tr>
</tbody></table>
<ul>
<li>Classç±»ä¸‹ç›¸å…³å±æ€§æ–¹æ³•</li>
</ul>
<table>
<thead>
<tr>
<th align="center">æ–¹æ³•å</th>
<th align="center">ç¿»è¯‘</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getField(java.lang.String)">getField(String name)</a></td>
<td align="center">è·å–æŸä¸ªå…¬æœ‰çš„å±æ€§å¯¹è±¡</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getFields()">getFields()</a></td>
<td align="center">è·å–æ‰€æœ‰å…¬æœ‰çš„å±æ€§å¯¹è±¡</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getDeclaredField(java.lang.String)">getDeclaredField(String name)</a>)</td>
<td align="center">è·å–æŸä¸ªç§æœ‰å±æ€§å¯¹è±¡</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getDeclaredFields()">getDeclaredFields()</a></td>
<td align="center">è·å–æ‰€æœ‰ç§æœ‰å±æ€§å¯¹è±¡</td>
</tr>
</tbody></table>
<ul>
<li>Class ç±»ä¸‹ç›¸å…³æ³¨è§£æ–¹æ³•</li>
</ul>
<table>
<thead>
<tr>
<th align="center">æ–¹æ³•å</th>
<th align="center">ç¿»è¯‘</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getDeclaredAnnotations()">getDeclaredAnnotations()</a></td>
<td align="center">è¿”å›å¯¹åº”ç±»ä¸‹æ‰€æœ‰æ³¨è§£å¯¹è±¡</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getDeclaredAnnotation(java.lang.Class%3CA%3E)">getDeclaredAnnotation(Class<A> annotationClass)</a></td>
<td align="center">è¿”å›å¯¹åº”ç±»ä¸­ä¸å‚æ•°ç±»å‹åŒ¹é…çš„æ‰€æœ‰æ³¨è§£å¯¹è±¡</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getAnnotation(java.lang.Class%3CA%3E)">getAnnotation(Class<A> annotationClass)</a></td>
<td align="center">è¿”å›å¯¹åº”ç±»ä¸­ä¸å‚æ•°ç±»å‹åŒ¹é…çš„å…¬æœ‰æ³¨è§£å¯¹è±¡</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getAnnotations()">getAnnotations ()</a></td>
<td align="center">è¿”å›å¯¹åº”ç±»ä¸­æ‰€æœ‰å…¬æœ‰æ³¨è§£å¯¹è±¡</td>
</tr>
</tbody></table>
<ul>
<li>Class ç±»ä¸‹å…¶å®ƒç›¸å…³æ–¹æ³•</li>
</ul>
<table>
<thead>
<tr>
<th align="center">æ–¹æ³•å</th>
<th align="center">ç¿»è¯‘</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getMethods()">getMethods()</a></td>
<td align="center">è¿”å›è¯¥ç±»æ‰€æœ‰å…¬æœ‰çš„æ–¹æ³•</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getMethod(java.lang.String,%20java.lang.Class%3C?%3E...)">getMethod (String name, Classâ€¦&lt;?&gt; parameterTypes)</a></td>
<td align="center">è¿”å›è¯¥ç±»æŸä¸ªå…¬æœ‰æ–¹æ³•</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getDeclaredMethod(java.lang.String,%20java.lang.Class%3C?%3E...)">getDeclaredMethod(String name, Classâ€¦&lt;?&gt; parameterTypes)</a></td>
<td align="center">è¿”å›è¯¥ç±»æŸä¸ªæ–¹æ³•</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/Class#getDeclaredMethods()">getDeclaredMethods()</a></td>
<td align="center">è¿”å›è¯¥ç±»æ‰€æœ‰æ–¹æ³•</td>
</tr>
</tbody></table>
<p><a href="https://developer.android.google.cn/reference/java/lang/reflect/Field">. Method</a></p>
<ul>
<li>Methodç±»ä¸‹éƒ¨åˆ†å¸¸ç”¨æ–¹æ³•</li>
</ul>
<table>
<thead>
<tr>
<th align="center">æ–¹æ³•å</th>
<th align="center">ç¿»è¯‘</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/reflect/Method#invoke(java.lang.Object,%20java.lang.Object...)">invoke(Object obj, Objectâ€¦ args)</a></td>
<td align="center">ä¼ é€’objectå¯¹è±¡åŠå‚æ•°è°ƒç”¨è¯¥å¯¹è±¡å¯¹åº”çš„æ–¹æ³•</td>
</tr>
</tbody></table>
<p><a href="https://developer.android.google.cn/reference/java/lang/reflect/Field">. Field</a></p>
<ul>
<li>Fieldç±»ä¸‹éƒ¨åˆ†å¸¸ç”¨æ–¹æ³•</li>
</ul>
<table>
<thead>
<tr>
<th align="center">æ–¹æ³•å</th>
<th align="center">ç¿»è¯‘</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/reflect/Field#get(java.lang.Object)">get(Object obj)</a></td>
<td align="center">è·å¾—objä¸­å¯¹åº”çš„å±æ€§å€¼</td>
</tr>
<tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/reflect/Field#set(java.lang.Object,%20java.lang.Object)">set(Object obj, Object value)</a></td>
<td align="center">è®¾ç½®objä¸­å¯¹åº”å±æ€§å€¼</td>
</tr>
</tbody></table>
<p><a href="https://developer.android.google.cn/reference/java/lang/reflect/Constructor">. Constructor</a></p>
<ul>
<li>Constructorç±»ä¸‹éƒ¨åˆ†å¸¸ç”¨æ–¹æ³•</li>
</ul>
<table>
<thead>
<tr>
<th align="center">æ–¹æ³•å</th>
<th align="center">ç¿»è¯‘</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><a href="https://developer.android.google.cn/reference/java/lang/reflect/Constructor#newInstance(java.lang.Object...)">newInstance(Objectâ€¦ initargs)</a></td>
<td align="center">æ ¹æ®ä¼ é€’çš„å‚æ•°åˆ›å»ºç±»çš„å¯¹è±¡</td>
</tr>
</tbody></table>
<h1 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h1><ul>
<li>åå°„å®ä½“ç±»<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GloryOfKings</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String role;</span><br><span class="line">    <span class="keyword">private</span> String skills;</span><br><span class="line">    <span class="keyword">private</span> String explain;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">GloryOfKings</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="title function_">GloryOfKings</span><span class="params">(String role, String skills)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.role = role;</span><br><span class="line">        <span class="built_in">this</span>.skills = skills;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getRole</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> role;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRole</span><span class="params">(String role)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.role = role;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getSkills</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> skills;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSkills</span><span class="params">(String skills)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.skills = skills;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setExplain</span><span class="params">(String explain)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.explain = explain;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getExplain</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> explain;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">week</span><span class="params">(<span class="type">int</span> flag)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">string</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">switch</span> (flag) &#123;</span><br><span class="line">            <span class="keyword">case</span> FlagMethod.monday:</span><br><span class="line">                string = <span class="string">&quot;å¤©æ°”æ™´æœ—&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> FlagMethod.tuesday:</span><br><span class="line">                string = <span class="string">&quot;å¤šäº‘&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> FlagMethod.Wednesday:</span><br><span class="line">                string = <span class="string">&quot;å¾®é£&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> FlagMethod.Thursday:</span><br><span class="line">                string = <span class="string">&quot;é˜µé£6çº§&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> FlagMethod.Friday:</span><br><span class="line">                string = <span class="string">&quot;ä¸­é›¨&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> FlagMethod.Saturday:</span><br><span class="line">                string = <span class="string">&quot;å¤§é›¨&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> FlagMethod.Sunday:</span><br><span class="line">                string = <span class="string">&quot;æ™´æœ—&quot;</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                string = <span class="string">&quot;-.-&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> string;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
<li>é€»è¾‘å°è£…ç±»<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Reflect</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åå°„-åˆ›å»ºå¯¹è±¡ï¼ˆä¸‰ç§æ–¹å¼ï¼š.classã€new MyClass().getClassï¼ŒClass.forName(&quot;ç±»çš„å…¨è·¯å¾„&quot;)ï¼‰</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">newInstance</span><span class="params">(<span class="type">int</span> flag)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">outMessage</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">switch</span> (flag) &#123;</span><br><span class="line">                <span class="keyword">case</span> FlagSource.newInstanceOne:</span><br><span class="line">                    Class&lt;GloryOfKings&gt; cls = GloryOfKings.class;</span><br><span class="line">                    <span class="type">GloryOfKings</span> <span class="variable">gloryOfKings</span> <span class="operator">=</span> cls.newInstance();</span><br><span class="line">                    gloryOfKings.setExplain(<span class="string">&quot;åˆ›å»ºå¯¹è±¡æ–¹å¼- GloryOfKings.class&quot;</span>);</span><br><span class="line">                    gloryOfKings.setRole(<span class="string">&quot;æå…ƒèŠ³&quot;</span>);</span><br><span class="line">                    gloryOfKings.setSkills(<span class="string">&quot;åˆ©åˆƒé£æš´&quot;</span>);</span><br><span class="line">                    outMessage = gloryOfKings.toString();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> FlagSource.newInstanceTwo:</span><br><span class="line">                    Class&lt;? <span class="keyword">extends</span> <span class="title class_">GloryOfKings</span>&gt; cls1 = <span class="keyword">new</span> <span class="title class_">GloryOfKings</span>().getClass();</span><br><span class="line">                    <span class="type">GloryOfKings</span> <span class="variable">gloryOfKings1</span> <span class="operator">=</span> cls1.newInstance();</span><br><span class="line">                    gloryOfKings1.setExplain(<span class="string">&quot;åˆ›å»ºå¯¹è±¡æ–¹å¼- new GloryOfKings().getClass()&quot;</span>);</span><br><span class="line">                    gloryOfKings1.setRole(<span class="string">&quot;åç¾¿&quot;</span>);</span><br><span class="line">                    gloryOfKings1.setSkills(<span class="string">&quot;ç¼æ—¥ä¹‹çŸ¢â€&quot;</span>);</span><br><span class="line">                    outMessage = gloryOfKings1.toString();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> FlagSource.newInstanceThree:</span><br><span class="line">                    Class&lt;?&gt; cls2 = Class.forName(<span class="string">&quot;com.linked.business.reflect.GloryOfKings&quot;</span>);</span><br><span class="line">                    <span class="type">GloryOfKings</span> <span class="variable">gloryOfKings2</span> <span class="operator">=</span> (GloryOfKings) cls2.newInstance();</span><br><span class="line">                    gloryOfKings2.setExplain(<span class="string">&quot;åˆ›å»ºå¯¹è±¡æ–¹å¼- Class.forName()&quot;</span>);</span><br><span class="line">                    gloryOfKings2.setRole(<span class="string">&quot;è¯¸è‘›äº®&quot;</span>);</span><br><span class="line">                    gloryOfKings2.setSkills(<span class="string">&quot;æ—¶ç©ºç©¿æ¢­â€&quot;</span>);</span><br><span class="line">                    outMessage = gloryOfKings2.toString();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(outMessage);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åå°„-ç§æœ‰æ„é€ æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">construction</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class&lt;?&gt; cls = Class.forName(<span class="string">&quot;com.linked.business.reflect.GloryOfKings&quot;</span>);</span><br><span class="line">            Constructor&lt;?&gt; constructor = cls.getDeclaredConstructor(String.class, String.class);</span><br><span class="line">            constructor.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> constructor.newInstance(<span class="string">&quot; åå°„-è®¾ç½®ç§æœ‰æ„é€ æ–¹æ³•ï¼šåç§°&quot;</span>, <span class="string">&quot; åå°„-è·å–ç§æœ‰æ„é€ æ–¹æ³•ï¼šç¦åˆ©&quot;</span>);</span><br><span class="line">            <span class="type">GloryOfKings</span> <span class="variable">go</span> <span class="operator">=</span> (GloryOfKings) obj;</span><br><span class="line">            System.out.println(<span class="string">&quot;åå°„-è·å–ç§æœ‰æ„é€ æ–¹æ³•&quot;</span> + go);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åå°„-ç§æœ‰å±æ€§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">reflectDeclaredAttribute</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class&lt;?&gt; cls = Class.forName(<span class="string">&quot;com.linked.business.reflect.GloryOfKings&quot;</span>);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> cls.newInstance();</span><br><span class="line">            <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> cls.getDeclaredField(<span class="string">&quot;TAG&quot;</span>);</span><br><span class="line">            field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> (String) field.get(obj);</span><br><span class="line">            System.out.println(<span class="string">&quot;åå°„-è·å–ç§æœ‰å±æ€§&quot;</span> + str);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åå°„-ç§æœ‰æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;å°†æ­¤å¯¹è±¡çš„ accessible æ ‡å¿—è®¾ç½®ä¸ºæŒ‡ç¤ºçš„å¸ƒå°”å€¼ã€‚å€¼ä¸º true åˆ™æŒ‡ç¤ºåå°„çš„å¯¹è±¡åœ¨ä½¿ç”¨æ—¶åº”è¯¥å–æ¶ˆ Java è¯­è¨€è®¿é—®æ£€æŸ¥ã€‚å€¼ä¸º false åˆ™æŒ‡ç¤ºåå°„çš„å¯¹è±¡åº”è¯¥å®æ–½ Java è¯­è¨€è®¿é—®æ£€æŸ¥;</span></span><br><span class="line"><span class="comment">     * å®é™…ä¸ŠsetAccessibleæ˜¯å¯ç”¨å’Œç¦ç”¨è®¿é—®å®‰å…¨æ£€æŸ¥çš„å¼€å…³,å¹¶ä¸æ˜¯ä¸ºtrueå°±èƒ½è®¿é—®ä¸ºfalseå°±ä¸èƒ½è®¿é—® ï¼›</span></span><br><span class="line"><span class="comment">     * ç”±äºJDKçš„å®‰å…¨æ£€æŸ¥è€—æ—¶è¾ƒå¤š.æ‰€ä»¥é€šè¿‡setAccessible(true)çš„æ–¹å¼å…³é—­å®‰å…¨æ£€æŸ¥å°±å¯ä»¥è¾¾åˆ°æå‡åå°„é€Ÿåº¦çš„ç›®çš„</span></span><br><span class="line"><span class="comment">     * &lt;/p&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">privateMethod</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class&lt;?&gt; cls = Class.forName(<span class="string">&quot;com.linked.business.reflect.GloryOfKings&quot;</span>);</span><br><span class="line">            <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> cls.getDeclaredMethod(<span class="string">&quot;week&quot;</span>, <span class="type">int</span>.class);</span><br><span class="line">            method.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> cls.newInstance();</span><br><span class="line">            <span class="comment">//invokeï¼šä¼ é€’objectå¯¹è±¡åŠå‚æ•°è°ƒç”¨è¯¥å¯¹è±¡å¯¹åº”çš„æ–¹æ³•</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> (String) method.invoke(obj, FlagMethod.monday);</span><br><span class="line">            System.out.println(str);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>æµ‹è¯•ç±»<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReflectTest</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Reflect.newInstance(FlagSource.newInstanceTwo);</span><br><span class="line">            Reflect.attribute();</span><br><span class="line">            Reflect.construction();</span><br><span class="line">            Reflect.privateMethod();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
  <entry>
    <title>Java-é“¾è¡¨ï¼ˆå•å‘ã€å¾ªç¯ã€åŒå‘ï¼‰</title>
    <url>/relaxed/java-%E9%93%BE%E8%A1%A8/</url>
    <content><![CDATA[<h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>ä»€ä¹ˆæ˜¯é“¾è¡¨ï¼Ÿé“¾è¡¨æ˜¯ä¸€ç§å¸¸è§çš„åŸºç¡€æ•°æ®ç»“æ„ï¼Œæ˜¯ä¸€ç§çº¿æ€§è¡¨ï¼Œä½†å¹¶ä¸ä¼šæŒ‰çº¿æ€§çš„é¡ºåºå­˜å‚¨æ•°æ®ï¼Œè€Œæ˜¯åœ¨æ¯ä¸€ä¸ªèŠ‚ç‚¹é‡Œå­˜åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆæ¥åšå…³è”ï¼ŒåŒæ—¶é“¾è¡¨ä¹Ÿåˆ†ä¸ºï¼Œå•é“¾è¡¨ã€åŒé“¾è¡¨ã€å¾ªç¯é“¾è¡¨ã€‚</p>
<h2 id="å•é“¾è¡¨ï¼ˆå•å‘é“¾è¡¨ï¼‰"><a href="#å•é“¾è¡¨ï¼ˆå•å‘é“¾è¡¨ï¼‰" class="headerlink" title="å•é“¾è¡¨ï¼ˆå•å‘é“¾è¡¨ï¼‰"></a>å•é“¾è¡¨ï¼ˆå•å‘é“¾è¡¨ï¼‰</h2><h3 id="å•é“¾è¡¨ç”±ä¸¤ä¸ªéƒ¨åˆ†æ„æˆ"><a href="#å•é“¾è¡¨ç”±ä¸¤ä¸ªéƒ¨åˆ†æ„æˆ" class="headerlink" title="å•é“¾è¡¨ç”±ä¸¤ä¸ªéƒ¨åˆ†æ„æˆ"></a>å•é“¾è¡¨ç”±ä¸¤ä¸ªéƒ¨åˆ†æ„æˆ</h3><ul>
<li>  DATAåŸŸï¼šæ•°æ®åŸŸã€ç”¨æ¥å­˜å‚¨æ•°æ®å…ƒç´ </li>
<li>  NEXTåŸŸï¼šæŒ‡é’ˆåŸŸã€ç”¨æ¥æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</li>
</ul>
<p><img src="https://s1.ax1x.com/2022/03/24/q3RB60.jpg" alt="å•é“¾è¡¨"></p>
<p>é“¾è¡¨ä¸æ•°ç»„ç±»ä¼¼,ä¹Ÿå¯ä»¥è¿›è¡ŒæŸ¥æ‰¾ã€æ’å…¥ã€åˆ é™¤ã€è¯»å–ç­‰æ“ä½œ,ä½†æ˜¯ç”±äºé“¾è¡¨ä¸æ•°ç»„çš„ç‰¹æ€§ä¸åŒ,å¯¼è‡´ä¸åŒæ“ä½œçš„å¤æ‚åº¦ä¹Ÿä¸åŒ</p>
<h3 id="æŸ¥æ‰¾æ–¹å¼"><a href="#æŸ¥æ‰¾æ–¹å¼" class="headerlink" title="æŸ¥æ‰¾æ–¹å¼"></a>æŸ¥æ‰¾æ–¹å¼</h3><ul>
<li><p>  ä»å¤´èŠ‚ç‚¹è¿›å…¥,å¼€å§‹æ¯”å¯¹èŠ‚ç‚¹çš„å€¼,å¦‚æœä¸åŒåˆ™é€šè¿‡æŒ‡é’ˆè¿›å…¥ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</p>
</li>
<li><p>  é‡å¤ä¸Šé¢çš„åŠ¨ä½œ,ç›´åˆ°æ‰¾åˆ°ç›¸åŒçš„å€¼,æˆ–è€…èŠ‚ç‚¹çš„æŒ‡é’ˆæŒ‡å‘null</p>
</li>
<li><p>  æ—¶é—´å¤æ‚åº¦ä¸ºO(n)</p>
</li>
</ul>
<h3 id="æ’å…¥æˆ–åˆ é™¤æ–¹å¼"><a href="#æ’å…¥æˆ–åˆ é™¤æ–¹å¼" class="headerlink" title="æ’å…¥æˆ–åˆ é™¤æ–¹å¼"></a>æ’å…¥æˆ–åˆ é™¤æ–¹å¼</h3><p>é“¾è¡¨ä¸æ•°ç»„æœ€å¤§çš„ä¸åŒå°±åœ¨äºåˆ é™¤ã€æ’å…¥çš„æ€§èƒ½ä¼˜åŠ¿,ç”±äºé“¾è¡¨æ˜¯éè¿ç»­çš„å†…å­˜,æ‰€ä»¥ä¸ç”¨åƒæ•°ç»„ä¸€æ ·åœ¨æ’å…¥ã€åˆ é™¤æ“ä½œçš„æ—¶å€™éœ€è¦è¿›è¡Œå¤§é¢ç§¯çš„æˆå‘˜ä½ç§»,æ¯”å¦‚åœ¨aã€bèŠ‚ç‚¹ä¹‹é—´æ’å…¥ä¸€ä¸ªæ–°èŠ‚ç‚¹c,é“¾è¡¨åªéœ€è¦åš</p>
<ul>
<li>  aæ–­å¼€æŒ‡å‘bçš„æŒ‡é’ˆï¼Œå°†æŒ‡é’ˆæŒ‡å‘c</li>
<li>  cèŠ‚ç‚¹å°†æŒ‡é’ˆæŒ‡å‘bï¼Œå®Œæ¯•ï¼ˆè¿™æ‰æ˜¯é­…åŠ›æ‰€åœ¨ï¼‰</li>
</ul>
<p>æ’å…¥æˆ–åˆ é™¤åªéœ€è¦è°ƒæ•´æŒ‡é’ˆå³å¯ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ä¸ºO(1)</p>
<p>ä¸‹é¢çœ‹ä¸‹é“¾è¡¨çš„æ’å…¥ã€åˆ é™¤æ“ä½œ</p>
<p><img src="https://s1.ax1x.com/2022/03/24/q3Rgk4.jpg" alt="å•é“¾è¡¨æ’å…¥&amp;åˆ é™¤"></p>
<h3 id="è¯»å–æ–¹å¼"><a href="#è¯»å–æ–¹å¼" class="headerlink" title="è¯»å–æ–¹å¼"></a>è¯»å–æ–¹å¼</h3><p>é“¾è¡¨ä¸æ•°ç»„ç›¸æ¯”è¯»å–æ€§èƒ½æ˜¯æœ‰åŠ£åŠ¿çš„ã€‚æ•°ç»„è¯»å–æ“ä½œæ€§èƒ½é«˜æ•ˆæ˜¯å› ä¸ºå®ƒæ˜¯ä¸€å—è¿ç»­å†…å­˜ï¼Œè¯»å–é€šè¿‡å¯»å€å…¬å¼å°±å¯ä»¥å¿«é€Ÿå®šä½ï¼Œé“¾è¡¨éè¿ç»­å†…å­˜å¿…é¡»é€šè¿‡æŒ‡é’ˆèŠ‚ç‚¹ä¸€ä¸€éå†ã€‚</p>
<h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ul>
<li>  æ’¤é”€åŠŸèƒ½,è¿™ç§æ“ä½œæœ€å¤šè§äºå„ç§æ–‡æœ¬ã€å›¾å½¢ç¼–è¾‘å™¨ä¸­,æ’¤é”€é‡åšåœ¨ç¼–è¾‘å™¨åœºæ™¯ä¸‹å±äºå®¶å¸¸ä¾¿é¥­,å•å‘é“¾è¡¨ç”±äºè‰¯å¥½çš„åˆ é™¤ç‰¹æ€§åœ¨è¿™ä¸ªåœºæ™¯å¾ˆé€‚ç”¨</li>
<li>  å›¾ç‰‡é˜Ÿåˆ—ä¸Šä¼ </li>
<li>  â€¦</li>
</ul>
<h2 id="åŒé“¾è¡¨ï¼ˆåŒå‘é“¾è¡¨ï¼‰"><a href="#åŒé“¾è¡¨ï¼ˆåŒå‘é“¾è¡¨ï¼‰" class="headerlink" title="åŒé“¾è¡¨ï¼ˆåŒå‘é“¾è¡¨ï¼‰"></a>åŒé“¾è¡¨ï¼ˆåŒå‘é“¾è¡¨ï¼‰</h2><p>æˆ‘ä»¬çœ‹åˆ°åŒå‘é“¾è¡¨å¤šäº†ä¸€ä¸ªæ–°çš„æŒ‡é’ˆprevæŒ‡å‘èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹,å½“ç„¶ç”±äºå¤šäº†ä¸€ä¸ªæŒ‡é’ˆ,æ‰€ä»¥åŒå‘é“¾è¡¨è¦æ›´å å†…å­˜</p>
<p><img src="https://s1.ax1x.com/2022/03/24/q3RfpR.jpg" alt="åŒé“¾è¡¨"></p>
<h3 id="æ’å…¥æ“ä½œ"><a href="#æ’å…¥æ“ä½œ" class="headerlink" title="æ’å…¥æ“ä½œ"></a>æ’å…¥æ“ä½œ</h3><p>å‘åŒé“¾è¡¨ä¸­æ’å…¥ä¸€ä¸ªæ–°èŠ‚ç‚¹ï¼Œéœ€è¦é€šè¿‡è°ƒæ•´ä¸¤æ¬¡prevæŒ‡å‘å’Œä¸¤æ¬¡nextæŒ‡å‘æ¥å®Œæˆã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒXä¸ºæ–°èŠ‚ç‚¹ï¼Œå°†A1çš„nextæŒ‡å‘Xï¼Œå°†Xçš„nextæŒ‡å‘A2ï¼Œå°†A2çš„prevæŒ‡å‘Xï¼Œå°†Xçš„prevæŒ‡å‘A1å³å¯ã€‚</p>
<p><img src="https://s1.ax1x.com/2022/03/24/q3RT0O.jpg" alt="åŒé“¾è¡¨æ’å…¥"></p>
<h3 id="åˆ é™¤æ“ä½œ"><a href="#åˆ é™¤æ“ä½œ" class="headerlink" title="åˆ é™¤æ“ä½œ"></a>åˆ é™¤æ“ä½œ</h3><p>ä»åŒé“¾è¡¨ä¸­åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹ï¼Œéœ€è¦é€šè¿‡è°ƒæ•´ä¸€æ¬¡prevæŒ‡å‘å’Œä¸€æ¬¡nextæŒ‡å‘æ¥å®Œæˆã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåˆ é™¤A2èŠ‚ç‚¹ï¼Œå°†A1çš„nextæŒ‡å‘A3ï¼Œå°†A3çš„ prevæŒ‡å‘A1å³å¯ã€‚</p>
<p><img src="https://s1.ax1x.com/2022/03/24/q3RqtH.jpg" alt="åŒé“¾è¡¨åˆ é™¤"></p>
<h2 id="å¾ªç¯é“¾è¡¨"><a href="#å¾ªç¯é“¾è¡¨" class="headerlink" title="å¾ªç¯é“¾è¡¨"></a>å¾ªç¯é“¾è¡¨</h2><p>ç¯å½¢é“¾è¡¨åˆå«å¾ªç¯é“¾è¡¨ï¼Œæœ¬æ–‡è®²è¿°çš„æ˜¯å•å‘ç¯å½¢é“¾è¡¨ï¼Œå…¶ä¸å•é“¾è¡¨çš„å”¯ä¸€åŒºåˆ«æ˜¯å°¾éƒ¨èŠ‚ç‚¹çš„nextä¸å†ä¸ºç©ºï¼Œåˆ™æ˜¯æŒ‡å‘äº†å¤´éƒ¨èŠ‚ç‚¹ï¼Œè¿™æ ·ä¾¿å½¢æˆäº†ä¸€ä¸ªç¯ã€‚</p>
<p><img src="https://s1.ax1x.com/2022/03/24/q3RxjP.jpg" alt="å¾ªç¯é“¾è¡¨"></p>
<p>å°ç»“ï¼šé“¾è¡¨ä¸æ•°ç»„çš„çš„ä¸åŒä¹‹å¤„åœ¨äºæ•°ç»„æ˜¯ä¸€å—è¿ç»­çš„å†…å­˜,è€Œé“¾è¡¨å¯ä»¥ä¸æ˜¯è¿ç»­å†…å­˜,é“¾è¡¨çš„èŠ‚ç‚¹ä¸èŠ‚ç‚¹ä¹‹é—´é€šè¿‡æŒ‡é’ˆæ¥è”ç³»çš„</p>
<ul>
<li>  æ•°ç»„é™æ€åˆ†é…å†…å­˜ï¼Œé“¾è¡¨åŠ¨æ€åˆ†é…å†…å­˜</li>
<li>  æ•°ç»„åœ¨å†…å­˜ä¸­è¿ç»­ï¼Œé“¾è¡¨ä¸è¿ç»­</li>
<li>  æ•°ç»„å…ƒç´ åœ¨æ ˆåŒºï¼Œé“¾è¡¨å…ƒç´ åœ¨å †åŒº</li>
<li>  æ•°ç»„åˆ©ç”¨ä¸‹æ ‡å®šä½ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œé“¾è¡¨å®šä½å…ƒç´ æ—¶é—´å¤æ‚åº¦O(n)</li>
<li>  æ•°ç»„æ’å…¥æˆ–åˆ é™¤å…ƒç´ çš„æ—¶é—´å¤æ‚åº¦O(n)ï¼Œé“¾è¡¨çš„æ—¶é—´å¤æ‚åº¦O(1)</li>
</ul>
]]></content>
      <categories>
        <category>Java</category>
      </categories>
      <tags>
        <tag>Java</tag>
      </tags>
  </entry>
</search>
